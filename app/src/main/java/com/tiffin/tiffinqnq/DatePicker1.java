package com.tiffin.tiffinqnq;

import static android.content.ContentValues.TAG;

import android.annotation.SuppressLint;
import android.app.DatePickerDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.os.Build;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.DatePicker;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatActivity;

import com.google.android.gms.tasks.OnCompleteListener;
import com.google.android.gms.tasks.OnFailureListener;
import com.google.android.gms.tasks.OnSuccessListener;
import com.google.android.gms.tasks.Task;
import com.google.firebase.auth.FirebaseAuth;
import com.google.firebase.firestore.DocumentReference;
import com.google.firebase.firestore.DocumentSnapshot;
import com.google.firebase.firestore.FieldValue;
import com.google.firebase.firestore.FirebaseFirestore;
import com.google.firebase.firestore.QuerySnapshot;
import com.tiffin.tiffinqnq.SendNot.FCMSend;

import org.checkerframework.checker.nullness.qual.NonNull;

import java.time.LocalDate;
import java.time.YearMonth;
import java.time.ZoneId;
import java.time.format.DateTimeFormatter;
import java.time.temporal.ChronoUnit;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.Locale;
import java.util.Map;
import java.util.Objects;

public class DatePicker1 extends AppCompatActivity {

    // on below line we are creating variables.
    Button btninitialdate,btnhome;
    TextView tvinitialdate;
    String userID,textMonthnext,yn,textMonthnextnext,ynn,textmonth,y,name,phone,token,meal,dayb,notificationBody,notificationTitle;
    long t1;
    FirebaseFirestore fstore;
    FirebaseAuth auth;
    int a,fieldSizeDinner,fieldSizeLunch,alreadybooked1,alreadybookednext1;
    CheckBox cblunch,cbdinner,cblunchdinner,sevendaypaln,fifteendayplan,thirtydayplan,cbcustom;

    int daysthismonth,daysnextmonth,monthOfYearNext,yearNext,monthOfYearNextnext,yearNextnext;
    TextView textView;
Boolean admin;
    ArrayList<String> bookeddaysnextnextmonth1;
    @SuppressLint("MissingInflatedId")
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_date_picker);
        cbdinner=findViewById(R.id.cbdinner);
        cblunch=findViewById(R.id.cblunch);
        cbcustom=findViewById(R.id.cbcustom);
//        startDate=findViewById(R.id.startDate);
//        endDate=findViewById(R.id.endDate);
        textView=findViewById(R.id.textView);
        sevendaypaln=findViewById(R.id.sevendayplan);
        fifteendayplan=findViewById(R.id.fifteendayplan);
        thirtydayplan=findViewById(R.id.thirtydayplan);
        cblunchdinner=findViewById(R.id.cblunchdinner);
        // on below line we are initializing our variables.
        tvinitialdate = findViewById(R.id.tvinitialdate);
        btninitialdate=findViewById(R.id.btninitialdate);
        fstore=FirebaseFirestore.getInstance();
        auth = FirebaseAuth.getInstance();
        userID=auth.getCurrentUser().getUid();
        btnhome=findViewById(R.id.btnhome);

        // on below line we are adding click listener for our pick date button
        DocumentReference documentReference=fstore.collection("users").document(userID);
        documentReference.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
            @Override
            public void onComplete(Task<DocumentSnapshot> task) {
                if(task.isSuccessful()){
                    DocumentSnapshot documentSnapshot=task.getResult();
                    if(documentSnapshot!=null){
                         name=(documentSnapshot.getString("name"));
                         phone=(documentSnapshot.getString("phoneNo"));
                        textView.setText(" Welcome Mr. "+name+System.getProperty ("line.separator")+"Here is your meal plan");
                    }
                }
            }
        });

        cbcustom.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(b){
                    sevendaypaln.setEnabled(false);
                    fifteendayplan.setEnabled(false);
                    thirtydayplan.setEnabled(false);
                    if(cbdinner.isChecked()){
                        android.app.AlertDialog.Builder alert = new android.app.AlertDialog.Builder(DatePicker1.this);
                        final EditText edittext = new EditText(DatePicker1.this);
                        edittext.setText("8");
//                        Integer.parseInt(edittext.getText().toString());
                        alert.setMessage("You are booking DINNER !!");
                        alert.setTitle("Please enter Number of days of booking and click/choose start date");

                        alert.setView(edittext);

                        alert.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                //What ever you want to do with the value
                                a = Integer.parseInt(edittext.getText().toString());
                            }
                        });

                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                // what ever you want to do with No option.
                            }
                        });
                        alert.show();

                    }else if(cblunch.isChecked()){
                        android.app.AlertDialog.Builder alert = new android.app.AlertDialog.Builder(DatePicker1.this);
                        final EditText edittext = new EditText(DatePicker1.this);
                        edittext.setText("8");
//                        Integer.parseInt(edittext.getText().toString());
                        alert.setMessage("You are booking LUNCH !!");
                        alert.setTitle("Please enter Number of days of booking and click/choose start date");

                        alert.setView(edittext);

                        alert.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                //What ever you want to do with the value
                                a = Integer.parseInt(edittext.getText().toString());
                            }
                        });

                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                // what ever you want to do with No option.
                            }
                        });
                        alert.show();

                    }else if(cblunchdinner.isChecked()){
                        android.app.AlertDialog.Builder alert = new android.app.AlertDialog.Builder(DatePicker1.this);
                        final EditText edittext = new EditText(DatePicker1.this);
                        edittext.setText("8");
//                        Integer.parseInt(edittext.getText().toString());
                        alert.setMessage("You are booking LUNCH+DINNER !!");
                        alert.setTitle("Please enter Number of days of booking and click/choose start date");

                        alert.setView(edittext);

                        alert.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                //What ever you want to do with the value
                                a = Integer.parseInt(edittext.getText().toString());
                            }
                        });

                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                // what ever you want to do with No option.
                            }
                        });
                        alert.show();

                    }

                }else{
                    sevendaypaln.setEnabled(true);
                    fifteendayplan.setEnabled(true);
                    thirtydayplan.setEnabled(true);
                }
            }
        });
        sevendaypaln.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(b){
                    fifteendayplan.setEnabled(false);
                    thirtydayplan.setEnabled(false);
                    cbcustom.setEnabled(false);
                }else{
                    fifteendayplan.setEnabled(true);
                    thirtydayplan.setEnabled(true);
                    cbcustom.setEnabled(true);
                }

            }
        });
        fifteendayplan.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(b){
                    sevendaypaln.setEnabled(false);
                    thirtydayplan.setEnabled(false);
                    cbcustom.setEnabled(false);
                }else{
                    sevendaypaln.setEnabled(true);
                    thirtydayplan.setEnabled(true);
                    cbcustom.setEnabled(true);
                }

            }
        });
        thirtydayplan.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(b){
                    sevendaypaln.setEnabled(false);
                    fifteendayplan.setEnabled(false);
                    cbcustom.setEnabled(false);
                }else{
                    sevendaypaln.setEnabled(true);
                    fifteendayplan.setEnabled(true);
                    cbcustom.setEnabled(true);
                }

            }
        });
        cbdinner.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(!cbcustom.isChecked()){
                    if(b){
                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                        alert.setTitle(" Please choose starting date");
                        alert.setMessage("You are booking DINNER !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                            }
                        }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {

                            }
                        });
                        alert.show();
                        cblunch.setEnabled(false);
                        cblunchdinner.setEnabled(false);

                    }else {
                        cblunch.setEnabled(true);
                        cblunchdinner.setEnabled(true);
                    }
                }else{
                    if(b){
                        android.app.AlertDialog.Builder alert = new android.app.AlertDialog.Builder(DatePicker1.this);
                        final EditText edittext = new EditText(DatePicker1.this);
                        edittext.setText("8");
//                        Integer.parseInt(edittext.getText().toString());
                        alert.setMessage("You are booking DINNER !!");
                        alert.setTitle("Please enter Number of days of booking and click/choose start date");

                        alert.setView(edittext);

                        alert.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                //What ever you want to do with the value
                                a = Integer.parseInt(edittext.getText().toString());
                            }
                        });

                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                // what ever you want to do with No option.
                            }
                        });
                        alert.show();
                    /*
                                    AlertDialog.Builder alert = new AlertDialog.Builder(CustomCalendar.this);
                alert.setTitle(" Please choose starting date");
                alert.setMessage("You are booking DINNER !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {
                        //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                    }
                }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface dialogInterface, int i) {

                    }
                });
                    alert.show();
                    */
                        cblunch.setEnabled(false);
                        cblunchdinner.setEnabled(false);

                    }else{
                        cblunch.setEnabled(true);
                        cblunchdinner.setEnabled(true);
                    }
                }
            }
        });
        cblunch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(!cbcustom.isChecked()){
                    if(b){
                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                        alert.setTitle(" Please choose starting date");
                        alert.setMessage("You are booking LUNCH !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                            }
                        }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {

                            }
                        });
                        alert.show();
                        cbdinner.setEnabled(false);
                        cblunchdinner.setEnabled(false);

                    }else {
                        cbdinner.setEnabled(true);
                        cblunchdinner.setEnabled(true);
                    }
                }else{
                    if(b){
                        android.app.AlertDialog.Builder alert = new android.app.AlertDialog.Builder(DatePicker1.this);
                        final EditText edittext = new EditText(DatePicker1.this);
                        edittext.setText("8");
//                        Integer.parseInt(edittext.getText().toString());
                        alert.setMessage("You are booking LUNCH !!");
                        alert.setTitle("Please enter Number of days of booking and click/choose start date");

                        alert.setView(edittext);

                        alert.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                //What ever you want to do with the value
                                a = Integer.parseInt(edittext.getText().toString());
                            }
                        });

                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                // what ever you want to do with No option.
                            }
                        });
                        alert.show();

                        cbdinner.setEnabled(false);
                        cblunchdinner.setEnabled(false);

                    }else{
                        cbdinner.setEnabled(true);
                        cblunchdinner.setEnabled(true);
                    }
                }
//

            }
        });
        cblunchdinner.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
            @Override
            public void onCheckedChanged(CompoundButton compoundButton, boolean b) {
                if(!cbcustom.isChecked()){
                    if(b){
                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                        alert.setTitle(" Please choose starting date");
                        alert.setMessage("You are booking LUNCH+DINNER !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {
                                //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                            }
                        }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialogInterface, int i) {

                            }
                        });
                        alert.show();
                        cblunch.setEnabled(false);
                        cbdinner.setEnabled(false);

                    }else {
                        cblunch.setEnabled(true);
                        cbdinner.setEnabled(true);
                    }
                }else{
                    if(b){
                        android.app.AlertDialog.Builder alert = new android.app.AlertDialog.Builder(DatePicker1.this);
                        final EditText edittext = new EditText(DatePicker1.this);
                        edittext.setText("8");
//                        Integer.parseInt(edittext.getText().toString());
                        alert.setMessage("You are booking LUNCH+DINNER !!");
                        alert.setTitle("Please enter Number of days of booking and click/choose start date");

                        alert.setView(edittext);

                        alert.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                //What ever you want to do with the value
                                a = Integer.parseInt(edittext.getText().toString());
                            }
                        });

                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int whichButton) {
                                // what ever you want to do with No option.
                            }
                        });
                        alert.show();

                        cblunch.setEnabled(false);
                        cbdinner.setEnabled(false);

                    }else{
                        cblunch.setEnabled(true);
                        cbdinner.setEnabled(true);
                    }
                }
//

            }
        });
        btninitialdate.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                DocumentReference docIdRef = firestore.collection("users").document(userID);
                docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                    @Override
                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                        if (task.isSuccessful()) {
                            DocumentSnapshot document = task.getResult();
                            if (document.exists()) {
                                if (!document.get("name").equals("")) {
                                    int u=0;
                                    int w=0;
                                    int x=0;
                                    int y=0;
                                    int z=0;
                                    int uu=0;
                                    int vv=0;
                                    int ww=0;
                                    int xx=0;
                                    int yy=0;
                                    int zz=0;

                if(cbcustom.isChecked()) {
                    if(cbdinner.isChecked()){
                        u=1;
                    }else if(cblunch.isChecked()){
                        u=2;
                        Toast.makeText(DatePicker1.this, "add lunch "+a+"days", Toast.LENGTH_SHORT).show();
                    }else if(cblunchdinner.isChecked()){
                        u=3;

                        System.out.println(a+"..add custom lunch dinner");
                    }else{
                        u=4;
                        Toast.makeText(DatePicker1.this, "Choose meal type first plz", Toast.LENGTH_SHORT).show();
                    }

                }
                else
                    if(sevendaypaln.isChecked()) {
                    if (cbdinner.isChecked())
                    {
                        u=5;
                    }else if(cblunch.isChecked())
                    {
                        u=6;
                    }else if (cblunchdinner.isChecked())
                    {
                        u=7;
                    }else {
                        u=8;
                        Toast.makeText(DatePicker1.this, "Coose meal type first plz", Toast.LENGTH_SHORT).show();


                    }
                } else
                    if (fifteendayplan.isChecked())
                {
                    if (cbdinner.isChecked())
                    {
                        u=9;
                    }else if(cblunch.isChecked())
                    {
                        u=10;
                    }else if (cblunchdinner.isChecked())
                    {
                        u=11;
                        System.out.println("System will  be adding lunch dinner");
                    }else
                    {
                        u=12;
                        Toast.makeText(DatePicker1.this, "Choose meal type first plz", Toast.LENGTH_SHORT).show();

                    }
                } else
                if(thirtydayplan.isChecked())
                {
                    if (cbdinner.isChecked())
                    {
                        u=13;
                    }else if(cblunch.isChecked())
                    {
                        u=14;
                        checkAndAddMeal(30,"lunch");
                    }else if (cblunchdinner.isChecked())
                    {
                        u=15;
                        System.out.println("System will  be adding lunch dinner");
                    }else
                    {
                        u=16;
                        Toast.makeText(DatePicker1.this, "Coose meal type first plz", Toast.LENGTH_SHORT).show();

                    }
                } else
                {
                    u=17;
                    Toast.makeText(DatePicker1.this, "Please choose a meal plan", Toast.LENGTH_SHORT).show();
                }

                if(cbdinner.isChecked())
                {
                 if(sevendaypaln.isChecked())
                 {
                     u=18;

                 } else if (fifteendayplan.isChecked())
                 {
                     u=19;

                 }  else if (thirtydayplan.isChecked())
                 {
                     u=20;

                 }else if (cbcustom.isChecked())
                 {
                     u=21;

                 }else
                 {
                     u=22;
                     Toast.makeText(DatePicker1.this, "please chhose a meal plan", Toast.LENGTH_SHORT).show();
                 }
                }else
                if(cblunch.isChecked())
                {
                    if(sevendaypaln.isChecked())
                    {
                        u=23;

                    } else if (fifteendayplan.isChecked())
                    {
                        u=24;

                    }  else if (thirtydayplan.isChecked())
                    {
                        u=25;

                    }else if (cbcustom.isChecked())
                    {
                        u=26;

                    }else
                    {
                        u=27;
                        Toast.makeText(DatePicker1.this, "please chhose a meal plan", Toast.LENGTH_SHORT).show();
                    }
                }else
                if(cblunchdinner.isChecked())
                {
                    if(sevendaypaln.isChecked())
                    {
                        u=28;
                       ;
                    } else if (fifteendayplan.isChecked())
                    {
                        u=29;
                        Toast.makeText(DatePicker1.this, "add lunch dinner 15 day", Toast.LENGTH_SHORT).show();;
                    }  else if (thirtydayplan.isChecked())
                    {
                        u=30;


                    }else if (cbcustom.isChecked())
                    {
                        u=31;
                    }else
                    {
                        u=32;
                        Toast.makeText(DatePicker1.this, "please chhose a meal plan", Toast.LENGTH_SHORT).show();
                    }
                }

                if(u==1 || u==21){
                    System.out.println(a+" dinner");
                    int aa=a;
                    checkAndAddMeal(aa,"dinner");

                }else if(u==2 ||u==26){
                    int aa=a;
                    System.out.println(aa+" lunch");
                    checkAndAddMeal(aa,"lunch");
                }else if(u==3 || u==31){
                    checkAndAddLunchDinner(a,"dinner","lunch");
                    Toast.makeText(DatePicker1.this, "Add custom lunch dinner", Toast.LENGTH_SHORT).show();
                }else if (u==5 || u==18){
                    checkAndAddMeal(7,"dinner");

                }else if (u==6 || u==23){
                    checkAndAddMeal(7,"lunch");
                }else if(u==7 || u==28){
                    checkAndAddLunchDinner(7,"dinner","lunch");
                    Toast.makeText(DatePicker1.this, "add lunch dinner 7 day", Toast.LENGTH_SHORT).show();
                }else if(u==9 || u==19){
                    checkAndAddMeal(15,"dinner");
                }else if(u==10 || u==24){
                    checkAndAddMeal(15,"lunch");
                }else if(u==11 || u==29){
                    checkAndAddLunchDinner(15,"dinner","lunch");
                    Toast.makeText(DatePicker1.this, "add lunch dinner 15 day", Toast.LENGTH_SHORT).show();
                }else if(u==13 || u==20){
                    checkAndAddMeal(30,"dinner");
                }else if(u==14 || u==25){
                    checkAndAddMeal(30,"lunch");
                }else if (u==15 || u==30){
                    checkAndAddLunchDinner(30,"dinner","lunch");
                    Toast.makeText(DatePicker1.this, "add lunch dinner 30 day", Toast.LENGTH_SHORT).show();;
                }

                                }else{
                                    {
                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                        alert.setTitle(" Please update Profile with address");
                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                            @Override
                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                if (document.exists()) {
                                                    String phone= document.getString("phoneNo");
                                                    //Toast.makeText(CustomCalendar.this, phone, Toast.LENGTH_SHORT).show();
                                                    Intent intent=new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                    intent.putExtra("phone",phone);
                                                    startActivity(intent);
                                                    finish();
                                                }
//                                    Intent intent=new Intent(CustomCalendar.this, OtpUpdateProfile.class);
//                            startActivity(intent);
                                                //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                            }
                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                            @Override
                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                Intent intent=new Intent(DatePicker1.this, MainActivity.class);
                                                startActivity(intent);
                                                finish();
                                            }
                                        });
                                        alert.show();

                                    }

                                }
                            }
                        }
                    }
                });

            }
        });
        btnhome.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent=new Intent(getApplicationContext(),MainActivity.class);
                startActivity(intent);
                finish();
            }
        });

    }
    public void alertDialogAlreadyBooked()
    {
        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
        alert.setTitle("OOPS !!");
        alert.setMessage("You already have booked days in the range").setPositiveButton("ok", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                Intent intent=new Intent(getApplicationContext(),CustomCalendar.class);
                startActivity(intent);
                finish();
            }
        });
        alert.show();
    }
    public void alertDialogSuccessfulBooking()
    {
        if(cbdinner.isChecked()){
            meal="dinner";
        }else if(cblunch.isChecked()){
            meal="lunch";
        }else if(cblunchdinner.isChecked()){
            meal="lunch and dinner";
        }
        if(sevendaypaln.isChecked()){
            dayb="7";
        }else if(fifteendayplan.isChecked()){
            dayb="15";
        }else if(thirtydayplan.isChecked()){
            dayb="30";
        }
        if(cbcustom.isChecked()){
            dayb=String.valueOf(a);
        }

        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
        alert.setTitle("CONGRATULATIONS");
        alert.setMessage("You have successfully booked your "+meal).setPositiveButton("ok", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {
                Intent intent=new Intent(getApplicationContext(),CustomCalendar.class);
                startActivity(intent);
                finish();
            }
        });
        alert.show();
        sendNotificationtoAdmin();

    }
    public void checkAndAddMeal(int days,String meal)
    {


        final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

        final Calendar c1 = Calendar.getInstance();

        // on below line we are getting
        // our day, month and year.
        int year = c1.get(Calendar.YEAR);
        int month = c1.get(Calendar.MONTH);
        int day = c1.get(Calendar.DAY_OF_MONTH);




        // on below line we are creating a variable for date picker dialog.
        DatePickerDialog datePickerDialog = new DatePickerDialog(
                // on below line we are passing context.
                DatePicker1.this,
                new DatePickerDialog.OnDateSetListener() {
                    @Override
                    public void onDateSet(DatePicker view, int year,
                                          int monthOfYear, int dayOfMonth)
                    {

                        if(monthOfYear<11){
                            monthOfYearNext=monthOfYear+1;
                            yearNext=year;
                        } else if (monthOfYear==11) {
                            monthOfYearNext=0;
                            yearNext=year+1;

                        }
                        if(monthOfYear<10){
                            monthOfYearNextnext=monthOfYear+2;
                            yearNextnext=year;
                        } else if (monthOfYear==10) {
                            monthOfYearNextnext=0;
                            yearNextnext=year+1;

                        }

                        textmonth=MONTHS[monthOfYear];
                        textMonthnext=MONTHS[monthOfYearNext];
                        textMonthnextnext=MONTHS[monthOfYearNextnext];
                        y=String.valueOf(year);
                        yn=String.valueOf(yearNext);
                        ynn=String.valueOf(yearNextnext);
                        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                    @Override
                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                        DocumentSnapshot documentSnapshot=task.getResult();
                                        if(task.isSuccessful()){
                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                            {
                                                if (holidays!=null){
                                                    if(holidays.contains(String.valueOf(dayOfMonth)))

                                                    {
                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                        alert.setTitle(" OOPS !! Initial selected date is a holiday");
                                                        alert.setMessage(" Booking will be from next available day! Do you want to proceed?").setPositiveButton("YES", new DialogInterface.OnClickListener() {
                                                            @Override
                                                            public void onClick(DialogInterface dialogInterface, int i)
                                                            {

                                                                if (!cbcustom.isChecked()) {
                                                                    if (monthOfYear < 11) {
                                                                        monthOfYearNext = monthOfYear + 1;
                                                                        yearNext = year;
                                                                    } else if (monthOfYear == 11) {
                                                                        monthOfYearNext = 0;
                                                                        yearNext = year + 1;

                                                                    }
                                                                    if (monthOfYear < 10) {
                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                        yearNextnext = year;
                                                                    } else if (monthOfYear == 10) {
                                                                        monthOfYearNextnext = 0;
                                                                        yearNextnext = year + 1;

                                                                    }

                                                                    textmonth = MONTHS[monthOfYear];
                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                    y = String.valueOf(year);
                                                                    yn = String.valueOf(yearNext);
                                                                    ynn = String.valueOf(yearNextnext);
                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                    t1 = c1.getTimeInMillis();
                                                                    String y = String.valueOf(year);
                                                                    Calendar c11 = Calendar.getInstance();
                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    System.out.println(monthLastDatenext);
                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                            if (task.isSuccessful()) {
                                                                                DocumentSnapshot document = task.getResult();
                                                                                if (document.exists()) {
                                                                                    if (!document.get("name").equals("")) {
                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                    @Override
                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                        if (task.isSuccessful()) {
                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                        @Override
                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                int i = dayOfMonth;
                                                                                                                                int counterthisholidays = 0;
                                                                                                                                int counternextholidays = 0;
                                                                                                                                int alreadybookednext = 0;
                                                                                                                                int booknext = 0;
                                                                                                                                int bookthis = 0;
                                                                                                                                int alreadybooked = 0;
                                                                                                                                int k = 1;
                                                                                                                                int daysbookedthis;
                                                                                                                                System.out.println(i + "aa");
                                                                                                                                System.out.println(monthLastDate + "aaabbb");


                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                    if (holidays != null) {

                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                            counterthisholidays++;
                                                                                                                                            System.out.println(i);
//
                                                                                                                                        }


                                                                                                                                    }

                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                        System.out.println("dd");
                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("ee");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println(counterthisholidays + "ff");
                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                        bookthis = 1;
                                                                                                                                        System.out.println("gg");
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    System.out.println("hh");

                                                                                                                                    i++;
                                                                                                                                }
                                                                                                                                System.out.println(alreadybooked + "ii");
                                                                                                                                System.out.println(bookthis + "jj");
                                                                                                                                if (bookthis == 1) {
                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println((counterholidaysthis + "kkb"));
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "kk"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb1 kka"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth + "ll");
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "mm");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb2 kkc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext + "nn");
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "oo");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb3 ooa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    //counterholidaysthis++;
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((counterholidaysthis + "ppa"));
                                                                                                                                            System.out.println((l + "pp"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("ppa1"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth + "qq");
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "rr");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb4 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "tt");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(" fb5 uu");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }




                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println("vv");
                                                                                                                                    System.out.println(counterthisholidays + "vva");
                                                                                                                                    System.out.println(i - counterthisholidays + "vvaa");

                                                                                                                                }

                                                                                                                                if (alreadybooked == 2) {
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("already booked..");
                                                                                                                                    System.out.println("ww");

                                                                                                                                }

                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                    while (k <= monthLastDatenext) {

//
                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                            System.out.println("aaa");
                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                System.out.println("bbb");
                                                                                                                                                System.out.println(k + "ccc");
                                                                                                                                                counternextholidays++;

                                                                                                                                            }
                                                                                                                                        }


                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                            System.out.println("ddd");
                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                System.out.println("eee");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                            booknext = 3;
                                                                                                                                            System.out.println("fff");
                                                                                                                                            System.out.println(k);

                                                                                                                                            break;
                                                                                                                                        }

                                                                                                                                        k++;


                                                                                                                                    }


                                                                                                                                }

                                                                                                                                if (booknext == 3) {
                                                                                                                                    {
                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println("wwa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "ggg"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb6 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth + "hhh");
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "iii");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb7 jjj");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext + "kkk");
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "lll");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb8 mmm");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println(counternextholidays + "nnn");
                                                                                                                                    System.out.println("ooo");
                                                                                                                                    System.out.println(k - counternextholidays + "ppp");
                                                                                                                                }
                                                                                                                                if (alreadybookednext == 4) {
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                    System.out.println("qqq");
                                                                                                                                }

                                                                                                                            }

                                                                                                                        }
                                                                                                                    });
                                                                                                        }

                                                                                                    }
                                                                                                });

                                                                                    } else {
                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                if (document.exists()) {
                                                                                                    String phone = document.getString("phoneNo");
                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                    intent.putExtra("phone", phone);
                                                                                                    startActivity(intent);
                                                                                                    finish();
                                                                                                }
                                                                                            }
                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                startActivity(intent);
                                                                                                finish();
                                                                                            }
                                                                                        });
                                                                                        alert.show();

                                                                                    }
                                                                                }
                                                                            }

                                                                        }
                                                                    });

                                                                } else {
                                                                    DocumentReference documentReference = fstore.collection("users").document(userID).collection("events").document("dinner");
                                                                    documentReference.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(Task<DocumentSnapshot> task) {
                                                                            if (task.isSuccessful()) {
                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                if (documentSnapshot != null) {
                                                                                    Map<String, Object> map = documentSnapshot.getData();
                                                                                    fieldSizeDinner = map.size();
                                                                                    System.out.println("....++" + fieldSizeDinner);
                                                                                    DocumentReference documentReference1 = fstore.collection("users").document(userID).collection("events").document("lunch");
                                                                                    documentReference1.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                        @Override
                                                                                        public void onComplete(Task<DocumentSnapshot> task) {
                                                                                            if (task.isSuccessful()) {
                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                if (documentSnapshot != null) {
                                                                                                    Map<String, Object> map = documentSnapshot.getData();
                                                                                                    fieldSizeLunch = map.size();
                                                                                                    System.out.println("....++" + fieldSizeDinner);
                                                                                                    System.out.println("sss.." + fieldSizeLunch + "ttt.." + fieldSizeDinner);
                                                                                                    if (fieldSizeDinner < 2 && fieldSizeLunch < 2) {


                                                                                                        if (a < 7) {
                                                                                                            AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                            alert.setTitle(" First time Booking");
                                                                                                            alert.setMessage("First time booking, minimum 7 days required !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                                                                                                                @Override
                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                    cbcustom.setChecked(false);
                                                                                                                    //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                                                                }
                                                                                                            }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                                                                                                                @Override
                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {

                                                                                                                }
                                                                                                            });
                                                                                                            alert.show();
                                                                                                        } else {
                                                                                                            System.out.println("ttta");

                                                                                                            if (monthOfYear < 11) {
                                                                                                                monthOfYearNext = monthOfYear + 1;
                                                                                                                yearNext = year;
                                                                                                            } else if (monthOfYear == 11) {
                                                                                                                monthOfYearNext = 0;
                                                                                                                yearNext = year + 1;

                                                                                                            }
                                                                                                            if (monthOfYear < 10) {
                                                                                                                monthOfYearNextnext = monthOfYear + 2;
                                                                                                                yearNextnext = year;
                                                                                                            } else if (monthOfYear == 10) {
                                                                                                                monthOfYearNextnext = 0;
                                                                                                                yearNextnext = year + 1;

                                                                                                            }

                                                                                                            textmonth = MONTHS[monthOfYear];
                                                                                                            textMonthnext = MONTHS[monthOfYearNext];
                                                                                                            textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                            y = String.valueOf(year);
                                                                                                            yn = String.valueOf(yearNext);
                                                                                                            ynn = String.valueOf(yearNextnext);
                                                                                                            tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                            t1 = c1.getTimeInMillis();
                                                                                                            String y = String.valueOf(year);
                                                                                                            Calendar c11 = Calendar.getInstance();
                                                                                                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                            System.out.println(monthLastDatenext);

                                                                                                            FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                            docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                @Override
                                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                    if (task.isSuccessful()) {
                                                                                                                        DocumentSnapshot document = task.getResult();
                                                                                                                        if (document.exists()) {
                                                                                                                            if (!document.get("name").equals("")) {
                                                                                                                                fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                        get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                            @Override
                                                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                if (task.isSuccessful()) {
                                                                                                                                                    ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                    ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                    ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                                                            .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                                @Override
                                                                                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                                    DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                                    if (documentSnapshot.exists()) {
                                                                                                                                                                        ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                        ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                        ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                        System.out.println(textmonth + " " + y);
                                                                                                                                                                        int i = dayOfMonth;
                                                                                                                                                                        int counterthisholidays = 0;
                                                                                                                                                                        int counternextholidays = 0;
                                                                                                                                                                        int alreadybookednext = 0;
                                                                                                                                                                        int booknext = 0;
                                                                                                                                                                        int bookthis = 0;
                                                                                                                                                                        int alreadybooked = 0;
                                                                                                                                                                        int k = 1;
                                                                                                                                                                        int daysbookedthis;
                                                                                                                                                                        System.out.println(i + "uuu");
                                                                                                                                                                        while (i <= monthLastDate) {
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                                    System.out.println(i + "vvv");
                                                                                                                                                                                    counterthisholidays++;
                                                                                                                                                                                    System.out.println(counterthisholidays + "www");
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            if (bookeddaysthismonth != null) {
                                                                                                                                                                                System.out.println("xxx");
                                                                                                                                                                                if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                                    System.out.println("yyy");
                                                                                                                                                                                    System.out.println(i);
                                                                                                                                                                                    alreadybooked = 2;
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                            if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                                bookthis = 1;
                                                                                                                                                                                System.out.println("aab");
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println("aac");

                                                                                                                                                                            i++;
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println(alreadybooked);
                                                                                                                                                                        System.out.println(bookthis);
                                                                                                                                                                        if (bookthis == 1) {
                                                                                                                                                                            int counterholidaysnext = 0;
                                                                                                                                                                            int counterholidaysthis = 0;
                                                                                                                                                                            int counterholidaysnextnext = 0;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            {

                                                                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                            counterholidaysthis++;
                                                                                                                                                                                            System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    System.out.println((l + "aacab"));

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println(("fb9 aacaba"));
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                }
                                                                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                                System.out.println(daysthismonth);
                                                                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                                int counternextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb10 aaab");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextbook++;
                                                                                                                                                                                }

                                                                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                                                                int counternextnextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb11 aaaba");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextnextbook++;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            {

                                                                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                                        if (holidays.contains(String.valueOf(l))) {

                                                                                                                                                                                            System.out.println("aaabba");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    System.out.println((l + "aaabbaa"));

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb12 ss");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                }
                                                                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                                System.out.println(daysthismonth);
                                                                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                                int counternextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb13 aabbc");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextbook++;
                                                                                                                                                                                }

                                                                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                                                                int counternextnextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb14 aaabbb");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextnextbook++;

                                                                                                                                                                                }

                                                                                                                                                                            }

                                                                                                                                                                            System.out.println("..bookmeal");

                                                                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                                                                            System.out.println("f");
                                                                                                                                                                            System.out.println(counterthisholidays + "fa");
                                                                                                                                                                            System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                        }
                                                                                                                                                                        if (alreadybooked == 2) {
                                                                                                                                                                            System.out.println("already booked..");
                                                                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                                                                            System.out.println("ga");

                                                                                                                                                                        }

                                                                                                                                                                        if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                            daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                                                            while (k <= monthLastDatenext) {

//
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    System.out.println("aa");
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                        System.out.println("bb");
                                                                                                                                                                                        System.out.println(k + "c");
                                                                                                                                                                                        counternextholidays++;

                                                                                                                                                                                    }
                                                                                                                                                                                }


                                                                                                                                                                                System.out.println(counternextholidays);

                                                                                                                                                                                if (bookeddaysnextmonth != null) {
                                                                                                                                                                                    System.out.println("cc");
                                                                                                                                                                                    if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                        alreadybookednext = 4;
                                                                                                                                                                                        System.out.println("dd");
                                                                                                                                                                                        System.out.println(k);

                                                                                                                                                                                        break;

                                                                                                                                                                                    }

                                                                                                                                                                                }
                                                                                                                                                                                if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                                    booknext = 3;
                                                                                                                                                                                    System.out.println("ee");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;
                                                                                                                                                                                }

                                                                                                                                                                                k++;


                                                                                                                                                                            }


                                                                                                                                                                        }

                                                                                                                                                                        if (booknext == 3) {
                                                                                                                                                                            {
                                                                                                                                                                                int counterholidaysnext = 0;
                                                                                                                                                                                int counterholidaysthis = 0;
                                                                                                                                                                                int counterholidaysnextnext = 0;

                                                                                                                                                                                System.out.println("not null not null");

                                                                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                            counterholidaysthis++;
                                                                                                                                                                                            System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    System.out.println((l + "abca"));

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb15 ss");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                }
                                                                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                                System.out.println(daysthismonth);
                                                                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                                int counternextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb16 abcc");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextbook++;
                                                                                                                                                                                }

                                                                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                                                                int counternextnextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb17 abcdaa");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextnextbook++;

                                                                                                                                                                                }

                                                                                                                                                                            }

                                                                                                                                                                            System.out.println("..bookmealnext");

                                                                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                                                                            System.out.println(counternextholidays);
                                                                                                                                                                            System.out.println("ffa");
                                                                                                                                                                            System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                        }
                                                                                                                                                                        if (alreadybookednext == 4) {
                                                                                                                                                                            System.out.println("already booked next..");
                                                                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                                                                            System.out.println("ggaa");
                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                }
                                                                                                                                                            });
                                                                                                                                                }

                                                                                                                                            }
                                                                                                                                        });

                                                                                                                            } else {
                                                                                                                                AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                                alert.setTitle(" Please update Profile with address");
                                                                                                                                alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                                    @Override
                                                                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                        if (document.exists()) {
                                                                                                                                            String phone = document.getString("phoneNo");
                                                                                                                                            Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                            intent.putExtra("phone", phone);
                                                                                                                                            startActivity(intent);
                                                                                                                                            finish();
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                                    @Override
                                                                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                        Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                        startActivity(intent);
                                                                                                                                        finish();
                                                                                                                                    }
                                                                                                                                });
                                                                                                                                alert.show();

                                                                                                                            }
                                                                                                                        }
                                                                                                                    }

                                                                                                                }
                                                                                                            });

                                                                                                        }
                                                                                                    } else {
                                                                                                        {
                                                                                                            System.out.println("ttta");

                                                                                                            if (monthOfYear < 11) {
                                                                                                                monthOfYearNext = monthOfYear + 1;
                                                                                                                yearNext = year;
                                                                                                            } else if (monthOfYear == 11) {
                                                                                                                monthOfYearNext = 0;
                                                                                                                yearNext = year + 1;

                                                                                                            }
                                                                                                            if (monthOfYear < 10) {
                                                                                                                monthOfYearNextnext = monthOfYear + 2;
                                                                                                                yearNextnext = year;
                                                                                                            } else if (monthOfYear == 10) {
                                                                                                                monthOfYearNextnext = 0;
                                                                                                                yearNextnext = year + 1;

                                                                                                            }

                                                                                                            textmonth = MONTHS[monthOfYear];
                                                                                                            textMonthnext = MONTHS[monthOfYearNext];
                                                                                                            textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                            y = String.valueOf(year);
                                                                                                            yn = String.valueOf(yearNext);
                                                                                                            ynn = String.valueOf(yearNextnext);
                                                                                                            tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                            t1 = c1.getTimeInMillis();
                                                                                                            String y = String.valueOf(year);
                                                                                                            Calendar c11 = Calendar.getInstance();
                                                                                                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                            System.out.println(monthLastDatenext);

                                                                                                            FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                            docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                @Override
                                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                    if (task.isSuccessful()) {
                                                                                                                        DocumentSnapshot document = task.getResult();
                                                                                                                        if (document.exists()) {
                                                                                                                            if (!document.get("name").equals("")) {
                                                                                                                                fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                        get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                            @Override
                                                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                if (task.isSuccessful()) {
                                                                                                                                                    ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                    ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                    ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                                                            .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                                @Override
                                                                                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                                    DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                                    if (documentSnapshot.exists()) {
                                                                                                                                                                        ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                        ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                        ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                        System.out.println(textmonth + " " + y);
                                                                                                                                                                        int i = dayOfMonth;
                                                                                                                                                                        int counterthisholidays = 0;
                                                                                                                                                                        int counternextholidays = 0;
                                                                                                                                                                        int alreadybookednext = 0;
                                                                                                                                                                        int booknext = 0;
                                                                                                                                                                        int bookthis = 0;
                                                                                                                                                                        int alreadybooked = 0;
                                                                                                                                                                        int k = 1;
                                                                                                                                                                        int daysbookedthis;
                                                                                                                                                                        System.out.println(i + "uuu");
                                                                                                                                                                        while (i <= monthLastDate) {
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                                    System.out.println(i + "vvv");
                                                                                                                                                                                    counterthisholidays++;
                                                                                                                                                                                    System.out.println(counterthisholidays + "www");
                                                                                                                                                                                }
                                                                                                                                                                            }


                                                                                                                                                                            if (bookeddaysthismonth != null) {
                                                                                                                                                                                System.out.println("xxx");
                                                                                                                                                                                if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                                    System.out.println("yyy");
                                                                                                                                                                                    System.out.println(i);
                                                                                                                                                                                    alreadybooked = 2;
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                            if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                                bookthis = 1;
                                                                                                                                                                                System.out.println("aab");
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println("aac");

                                                                                                                                                                            i++;
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println(alreadybooked);
                                                                                                                                                                        System.out.println(bookthis);
                                                                                                                                                                        if (bookthis == 1) {
                                                                                                                                                                            int counterholidaysnext = 0;
                                                                                                                                                                            int counterholidaysthis = 0;
                                                                                                                                                                            int counterholidaysnextnext = 0;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            {

                                                                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                            counterholidaysthis++;
                                                                                                                                                                                            System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    System.out.println((l + "aacab"));

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println(("fb18 aacaba"));
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                }
                                                                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                                System.out.println(daysthismonth);
                                                                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                                int counternextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb19 aaab");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextbook++;
                                                                                                                                                                                }

                                                                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                                                                int counternextnextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb20 aaaba");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextnextbook++;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            {

                                                                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                            System.out.println("aaabba");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    System.out.println((l + "aaabbaa"));

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb21 ss");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                }
                                                                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                                System.out.println(daysthismonth);
                                                                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                                int counternextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb22 aabbc");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextbook++;
                                                                                                                                                                                }

                                                                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                                                                int counternextnextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb23 aaabbb");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextnextbook++;

                                                                                                                                                                                }

                                                                                                                                                                            }

                                                                                                                                                                            System.out.println("..bookmeal");
                                                                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                                                                            System.out.println("f");
                                                                                                                                                                            System.out.println(counterthisholidays + "fa");
                                                                                                                                                                            System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                        }
                                                                                                                                                                        if (alreadybooked == 2) {
                                                                                                                                                                            System.out.println("already booked..");
                                                                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                                                                            System.out.println("ga");

                                                                                                                                                                        }

                                                                                                                                                                        if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                            daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                                                            while (k <= monthLastDatenext) {

                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    System.out.println("aa");
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                        System.out.println("bb");
                                                                                                                                                                                        System.out.println(k + "c");
                                                                                                                                                                                        counternextholidays++;

                                                                                                                                                                                    }
                                                                                                                                                                                }


                                                                                                                                                                                System.out.println(counternextholidays);

                                                                                                                                                                                if (bookeddaysnextmonth != null) {
                                                                                                                                                                                    System.out.println("cc");
                                                                                                                                                                                    if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                        alreadybookednext = 4;
                                                                                                                                                                                        System.out.println("dd");
                                                                                                                                                                                        System.out.println(k);

                                                                                                                                                                                        break;

                                                                                                                                                                                    }

                                                                                                                                                                                }
                                                                                                                                                                                if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                                    booknext = 3;
                                                                                                                                                                                    System.out.println("ee");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;
                                                                                                                                                                                }

                                                                                                                                                                                k++;


                                                                                                                                                                            }


                                                                                                                                                                        }

                                                                                                                                                                        if (booknext == 3) {
                                                                                                                                                                            {
                                                                                                                                                                                int counterholidaysnext = 0;
                                                                                                                                                                                int counterholidaysthis = 0;
                                                                                                                                                                                int counterholidaysnextnext = 0;

                                                                                                                                                                                System.out.println("not null not null");

                                                                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                            counterholidaysthis++;
                                                                                                                                                                                            System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    System.out.println((l + "abca"));

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb24 ss");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                }
                                                                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                                System.out.println(daysthismonth);
                                                                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                                int counternextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }
                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb25 abcc");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextbook++;
                                                                                                                                                                                }

                                                                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                                                                int counternextnextbook = 0;
                                                                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                        break;
                                                                                                                                                                                    }
                                                                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                                                                            System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                            continue;
                                                                                                                                                                                        }
                                                                                                                                                                                    }

                                                                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                                                                    System.out.println("fb26 abcdaa");
                                                                                                                                                                                                }
                                                                                                                                                                                            })
                                                                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                                @Override
                                                                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                                }
                                                                                                                                                                                            });
                                                                                                                                                                                    counternextnextbook++;

                                                                                                                                                                                }

                                                                                                                                                                            }

                                                                                                                                                                            System.out.println("..bookmealnext");
                                                                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                                                                            System.out.println(counternextholidays);
                                                                                                                                                                            System.out.println("ffa");
                                                                                                                                                                            System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                        }
                                                                                                                                                                        if (alreadybookednext == 4) {
                                                                                                                                                                            System.out.println("already booked next..");
                                                                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                                                                            System.out.println("ggaa");
                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                }
                                                                                                                                                            });
                                                                                                                                                }

                                                                                                                                            }
                                                                                                                                        });

                                                                                                                            } else {
                                                                                                                                AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                                alert.setTitle(" Please update Profile with address");
                                                                                                                                alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                                    @Override
                                                                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                        if (document.exists()) {
                                                                                                                                            String phone = document.getString("phoneNo");
                                                                                                                                            Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                            intent.putExtra("phone", phone);
                                                                                                                                            startActivity(intent);
                                                                                                                                            finish();
                                                                                                                                        }
                                                                                                                                        ;
                                                                                                                                    }
                                                                                                                                }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                                    @Override
                                                                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                        Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                        startActivity(intent);
                                                                                                                                        finish();
                                                                                                                                    }
                                                                                                                                });
                                                                                                                                alert.show();

                                                                                                                            }
                                                                                                                        }
                                                                                                                    }

                                                                                                                }
                                                                                                            });

                                                                                                        }
                                                                                                    }

                                                                                                }

                                                                                            }

                                                                                        }
                                                                                    });

                                                                                }

                                                                            }

                                                                        }
                                                                    });
                                                                }
                                                            }
                                                        }).setNegativeButton("NO", new DialogInterface.OnClickListener() {
                                                            @Override
                                                            public void onClick(DialogInterface dialogInterface, int i) {

                                                            }
                                                        });
                                                        alert.show();

                                                    }


                                                    else {
                                                        if (!cbcustom.isChecked()){
//                                                            addMealFixedPlan(days,meal);

                                                        {
                                                            if (monthOfYear < 11) {
                                                                monthOfYearNext = monthOfYear + 1;
                                                                yearNext = year;
                                                            } else if (monthOfYear == 11) {
                                                                monthOfYearNext = 0;
                                                                yearNext = year + 1;

                                                            }
                                                            if (monthOfYear < 10) {
                                                                monthOfYearNextnext = monthOfYear + 2;
                                                                yearNextnext = year;
                                                            } else if (monthOfYear == 10) {
                                                                monthOfYearNextnext = 0;
                                                                yearNextnext = year + 1;

                                                            }

                                                            textmonth = MONTHS[monthOfYear];
                                                            textMonthnext = MONTHS[monthOfYearNext];
                                                            textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                            y = String.valueOf(year);
                                                            yn = String.valueOf(yearNext);
                                                            ynn = String.valueOf(yearNextnext);
                                                            tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                            t1 = c1.getTimeInMillis();
                                                            String y = String.valueOf(year);
                                                            Calendar c11 = Calendar.getInstance();
                                                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                            System.out.println(monthLastDatenext);
                                                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                            docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                @Override
                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                    if (task.isSuccessful()) {
                                                                        DocumentSnapshot document = task.getResult();
                                                                        if (document.exists()) {
                                                                            if (!document.get("name").equals("")) {
                                                                                fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                        get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                            @Override
                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                if (task.isSuccessful()) {
                                                                                                    ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                    ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                    ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                            .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                @Override
                                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                    DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                    if (documentSnapshot.exists()) {
                                                                                                                        ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                        ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                        ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                        System.out.println(textmonth + " " + y);
                                                                                                                        int i = dayOfMonth;
                                                                                                                        int counterthisholidays = 0;
                                                                                                                        int counternextholidays = 0;
                                                                                                                        int alreadybookednext = 0;
                                                                                                                        int booknext = 0;
                                                                                                                        int bookthis = 0;
                                                                                                                        int alreadybooked = 0;
                                                                                                                        int k = 1;
                                                                                                                        int daysbookedthis;
                                                                                                                        System.out.println(i + "aa");
                                                                                                                        System.out.println(monthLastDate + "aaabbb");


                                                                                                                        while (i <= monthLastDate) {
                                                                                                                            if (holidays != null) {

                                                                                                                                if (holidays.contains(String.valueOf(i))) {
                                                                                                                                    counterthisholidays++;
                                                                                                                                    System.out.println(i);
//
                                                                                                                                }


                                                                                                                            }

                                                                                                                            if (bookeddaysthismonth != null) {
                                                                                                                                System.out.println("dd");
                                                                                                                                if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                    System.out.println("ee");
                                                                                                                                    System.out.println(i);
                                                                                                                                    alreadybooked = 2;
                                                                                                                                    break;
                                                                                                                                }
                                                                                                                            }
                                                                                                                            System.out.println(counterthisholidays + "ff");
                                                                                                                            if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                bookthis = 1;
                                                                                                                                System.out.println("gg");
                                                                                                                                break;
                                                                                                                            }
                                                                                                                            System.out.println("hh");

                                                                                                                            i++;
                                                                                                                        }
                                                                                                                        System.out.println(alreadybooked + "ii");
                                                                                                                        System.out.println(bookthis + "jj");
                                                                                                                        if (bookthis == 1) {
                                                                                                                            int counterholidaysnext = 0;
                                                                                                                            int counterholidaysthis = 0;
                                                                                                                            int counterholidaysnextnext = 0;
                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                            {

                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                            counterholidaysthis++;
                                                                                                                                            System.out.println((counterholidaysthis + "kkb"));
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println((l + "kk"));

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println(("fb1 kka"));
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                }
                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                System.out.println(daysthismonth + "ll");
                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                int counternextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "mm");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb2 kkc");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextbook++;
                                                                                                                                }

                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                System.out.println(daysnextnext + "nn");
                                                                                                                                int counternextnextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "oo");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb3 ooa");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextnextbook++;

                                                                                                                                }

                                                                                                                            }
                                                                                                                            {

                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                            //counterholidaysthis++;
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println((counterholidaysthis + "ppa"));
                                                                                                                                    System.out.println((l + "pp"));

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println(("ppa1"));
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                }
                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                System.out.println(daysthismonth + "qq");
                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                int counternextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "rr");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb4 ss");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextbook++;
                                                                                                                                }

                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                int counternextnextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "tt");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println(" fb5 uu");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextnextbook++;

                                                                                                                                }

                                                                                                                            }

                                                                                                                            System.out.println("..bookmeal");
                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                            System.out.println("vv");
                                                                                                                            System.out.println(counterthisholidays + "vva");
                                                                                                                            System.out.println(i - counterthisholidays + "vvaa");

                                                                                                                        }

                                                                                                                        if (alreadybooked == 2) {
                                                                                                                            System.out.println("already booked..");
                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                            System.out.println("ww");

                                                                                                                        }

                                                                                                                        if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                            daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                            while (k <= monthLastDatenext) {

//
                                                                                                                                if (holidaysnext != null) {
                                                                                                                                    System.out.println("aaa");
                                                                                                                                    if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                        System.out.println("bbb");
                                                                                                                                        System.out.println(k + "ccc");
                                                                                                                                        counternextholidays++;

                                                                                                                                    }
                                                                                                                                }


                                                                                                                                System.out.println(counternextholidays);

                                                                                                                                if (bookeddaysnextmonth != null) {
                                                                                                                                    System.out.println("ddd");
                                                                                                                                    if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                        alreadybookednext = 4;
                                                                                                                                        System.out.println("eee");
                                                                                                                                        System.out.println(k);

                                                                                                                                        break;

                                                                                                                                    }

                                                                                                                                }
                                                                                                                                if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                    booknext = 3;
                                                                                                                                    System.out.println("fff");
                                                                                                                                    System.out.println(k);

                                                                                                                                    break;
                                                                                                                                }

                                                                                                                                k++;


                                                                                                                            }


                                                                                                                        }

                                                                                                                        if (booknext == 3) {
                                                                                                                            {
                                                                                                                                int counterholidaysnext = 0;
                                                                                                                                int counterholidaysthis = 0;
                                                                                                                                int counterholidaysnextnext = 0;

                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                            counterholidaysthis++;
                                                                                                                                            System.out.println("wwa");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println((l + "ggg"));

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb6 ss");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                }
                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                System.out.println(daysthismonth + "hhh");
                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                int counternextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "iii");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb7 jjj");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextbook++;
                                                                                                                                }

                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                System.out.println(daysnextnext + "kkk");
                                                                                                                                int counternextnextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "lll");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb8 mmm");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextnextbook++;

                                                                                                                                }

                                                                                                                            }

                                                                                                                            System.out.println("..bookmealnext");
                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                            System.out.println(counternextholidays + "nnn");
                                                                                                                            System.out.println("ooo");
                                                                                                                            System.out.println(k - counternextholidays + "ppp");
                                                                                                                        }
                                                                                                                        if (alreadybookednext == 4) {
                                                                                                                            System.out.println("already booked next..");
                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                            System.out.println("qqq");
                                                                                                                        }

                                                                                                                    }

                                                                                                                }
                                                                                                            });
                                                                                                }

                                                                                            }
                                                                                        });

                                                                            } else {
                                                                                AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                alert.setTitle(" Please update Profile with address");
                                                                                alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                    @Override
                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                        if (document.exists()) {
                                                                                            String phone = document.getString("phoneNo");
                                                                                            Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                            intent.putExtra("phone", phone);
                                                                                            startActivity(intent);
                                                                                            finish();
                                                                                        }
                                                                                    }
                                                                                }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                    @Override
                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                        Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                        startActivity(intent);
                                                                                        finish();
                                                                                    }
                                                                                });
                                                                                alert.show();

                                                                            }
                                                                        }
                                                                    }

                                                                }
                                                            });

                                                        }

                                                        }
                                                        else {
//                                                            addMealCustomPlan(days, meal);

                                                            {
                                                                DocumentReference documentReference = fstore.collection("users").document(userID).collection("events").document("dinner");
                                                                documentReference.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                    @Override
                                                                    public void onComplete(Task<DocumentSnapshot> task) {
                                                                        if (task.isSuccessful()) {
                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                            if (documentSnapshot != null) {
                                                                                Map<String, Object> map = documentSnapshot.getData();
                                                                                fieldSizeDinner = map.size();
                                                                                System.out.println("....++" + fieldSizeDinner);
                                                                                DocumentReference documentReference1 = fstore.collection("users").document(userID).collection("events").document("lunch");
                                                                                documentReference1.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                    @Override
                                                                                    public void onComplete(Task<DocumentSnapshot> task) {
                                                                                        if (task.isSuccessful()) {
                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                            if (documentSnapshot != null) {
                                                                                                Map<String, Object> map = documentSnapshot.getData();
                                                                                                fieldSizeLunch = map.size();
                                                                                                System.out.println("....++" + fieldSizeDinner);
                                                                                                System.out.println("sss.." + fieldSizeLunch + "ttt.." + fieldSizeDinner);
                                                                                                if (fieldSizeDinner < 2 && fieldSizeLunch < 2) {


                                                                                                    if (a < 7) {
                                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                        alert.setTitle(" First time Booking");
                                                                                                        alert.setMessage("First time booking, minimum 7 days required !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                                                                                                            @Override
                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                cbcustom.setChecked(false);
                                                                                                                //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                                                            }
                                                                                                        }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                                                                                                            @Override
                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {

                                                                                                            }
                                                                                                        });
                                                                                                        alert.show();
                                                                                                    } else {
                                                                                                        System.out.println("ttta");

                                                                                                        if (monthOfYear < 11) {
                                                                                                            monthOfYearNext = monthOfYear + 1;
                                                                                                            yearNext = year;
                                                                                                        } else if (monthOfYear == 11) {
                                                                                                            monthOfYearNext = 0;
                                                                                                            yearNext = year + 1;

                                                                                                        }
                                                                                                        if (monthOfYear < 10) {
                                                                                                            monthOfYearNextnext = monthOfYear + 2;
                                                                                                            yearNextnext = year;
                                                                                                        } else if (monthOfYear == 10) {
                                                                                                            monthOfYearNextnext = 0;
                                                                                                            yearNextnext = year + 1;

                                                                                                        }

                                                                                                        textmonth = MONTHS[monthOfYear];
                                                                                                        textMonthnext = MONTHS[monthOfYearNext];
                                                                                                        textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                        y = String.valueOf(year);
                                                                                                        yn = String.valueOf(yearNext);
                                                                                                        ynn = String.valueOf(yearNextnext);
                                                                                                        tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                        t1 = c1.getTimeInMillis();
                                                                                                        String y = String.valueOf(year);
                                                                                                        Calendar c11 = Calendar.getInstance();
                                                                                                        Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                        int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                        int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                        int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        System.out.println(monthLastDatenext);

                                                                                                        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                        DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                        docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                            @Override
                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                if (task.isSuccessful()) {
                                                                                                                    DocumentSnapshot document = task.getResult();
                                                                                                                    if (document.exists()) {
                                                                                                                        if (!document.get("name").equals("")) {
                                                                                                                            fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                    get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                        @Override
                                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                            if (task.isSuccessful()) {
                                                                                                                                                ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                                                        .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                            @Override
                                                                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                                if (documentSnapshot.exists()) {
                                                                                                                                                                    ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                    ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                    ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                    System.out.println(textmonth + " " + y);
                                                                                                                                                                    int i = dayOfMonth;
                                                                                                                                                                    int counterthisholidays = 0;
                                                                                                                                                                    int counternextholidays = 0;
                                                                                                                                                                    int alreadybookednext = 0;
                                                                                                                                                                    int booknext = 0;
                                                                                                                                                                    int bookthis = 0;
                                                                                                                                                                    int alreadybooked = 0;
                                                                                                                                                                    int k = 1;
                                                                                                                                                                    int daysbookedthis;
                                                                                                                                                                    System.out.println(i + "uuu");
                                                                                                                                                                    while (i <= monthLastDate) {
                                                                                                                                                                        if (holidays != null) {
                                                                                                                                                                            if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println(i + "vvv");
                                                                                                                                                                                counterthisholidays++;
                                                                                                                                                                                System.out.println(counterthisholidays + "www");
                                                                                                                                                                            }
                                                                                                                                                                        }

                                                                                                                                                                        if (bookeddaysthismonth != null) {
                                                                                                                                                                            System.out.println("xxx");
                                                                                                                                                                            if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println("yyy");
                                                                                                                                                                                System.out.println(i);
                                                                                                                                                                                alreadybooked = 2;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                        if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                            bookthis = 1;
                                                                                                                                                                            System.out.println("aab");
                                                                                                                                                                            break;
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println("aac");

                                                                                                                                                                        i++;
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println(alreadybooked);
                                                                                                                                                                    System.out.println(bookthis);
                                                                                                                                                                    if (bookthis == 1) {
                                                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                                                        int counterholidaysnextnext = 0;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aacab"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println(("fb9 aacaba"));
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb10 aaab");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb11 aaaba");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {

                                                                                                                                                                                        System.out.println("aaabba");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aaabbaa"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb12 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb13 aabbc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb14 aaabbb");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmeal");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println("f");
                                                                                                                                                                        System.out.println(counterthisholidays + "fa");
                                                                                                                                                                        System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                    }
                                                                                                                                                                    if (alreadybooked == 2) {
                                                                                                                                                                        System.out.println("already booked..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ga");

                                                                                                                                                                    }

                                                                                                                                                                    if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                        daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                                                        while (k <= monthLastDatenext) {

//
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                System.out.println("aa");
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                    System.out.println("bb");
                                                                                                                                                                                    System.out.println(k + "c");
                                                                                                                                                                                    counternextholidays++;

                                                                                                                                                                                }
                                                                                                                                                                            }


                                                                                                                                                                            System.out.println(counternextholidays);

                                                                                                                                                                            if (bookeddaysnextmonth != null) {
                                                                                                                                                                                System.out.println("cc");
                                                                                                                                                                                if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                    alreadybookednext = 4;
                                                                                                                                                                                    System.out.println("dd");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                                booknext = 3;
                                                                                                                                                                                System.out.println("ee");
                                                                                                                                                                                System.out.println(k);

                                                                                                                                                                                break;
                                                                                                                                                                            }

                                                                                                                                                                            k++;


                                                                                                                                                                        }


                                                                                                                                                                    }

                                                                                                                                                                    if (booknext == 3) {
                                                                                                                                                                        {
                                                                                                                                                                            int counterholidaysnext = 0;
                                                                                                                                                                            int counterholidaysthis = 0;
                                                                                                                                                                            int counterholidaysnextnext = 0;

                                                                                                                                                                            System.out.println("not null not null");

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "abca"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb15 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb16 abcc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb17 abcdaa");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmealnext");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println(counternextholidays);
                                                                                                                                                                        System.out.println("ffa");
                                                                                                                                                                        System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                    }
                                                                                                                                                                    if (alreadybookednext == 4) {
                                                                                                                                                                        System.out.println("already booked next..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ggaa");
                                                                                                                                                                    }

                                                                                                                                                                }

                                                                                                                                                            }
                                                                                                                                                        });
                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                    });

                                                                                                                        } else {
                                                                                                                            AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                            alert.setTitle(" Please update Profile with address");
                                                                                                                            alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    if (document.exists()) {
                                                                                                                                        String phone = document.getString("phoneNo");
                                                                                                                                        Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                        intent.putExtra("phone", phone);
                                                                                                                                        startActivity(intent);
                                                                                                                                        finish();
                                                                                                                                    }
                                                                                                                                }
                                                                                                                            }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                    startActivity(intent);
                                                                                                                                    finish();
                                                                                                                                }
                                                                                                                            });
                                                                                                                            alert.show();

                                                                                                                        }
                                                                                                                    }
                                                                                                                }

                                                                                                            }
                                                                                                        });

                                                                                                    }
                                                                                                } else {
                                                                                                    {
                                                                                                        System.out.println("ttta");

                                                                                                        if (monthOfYear < 11) {
                                                                                                            monthOfYearNext = monthOfYear + 1;
                                                                                                            yearNext = year;
                                                                                                        } else if (monthOfYear == 11) {
                                                                                                            monthOfYearNext = 0;
                                                                                                            yearNext = year + 1;

                                                                                                        }
                                                                                                        if (monthOfYear < 10) {
                                                                                                            monthOfYearNextnext = monthOfYear + 2;
                                                                                                            yearNextnext = year;
                                                                                                        } else if (monthOfYear == 10) {
                                                                                                            monthOfYearNextnext = 0;
                                                                                                            yearNextnext = year + 1;

                                                                                                        }

                                                                                                        textmonth = MONTHS[monthOfYear];
                                                                                                        textMonthnext = MONTHS[monthOfYearNext];
                                                                                                        textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                        y = String.valueOf(year);
                                                                                                        yn = String.valueOf(yearNext);
                                                                                                        ynn = String.valueOf(yearNextnext);
                                                                                                        tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                        t1 = c1.getTimeInMillis();
                                                                                                        String y = String.valueOf(year);
                                                                                                        Calendar c11 = Calendar.getInstance();
                                                                                                        Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                        int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                        int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                        int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        System.out.println(monthLastDatenext);

                                                                                                        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                        DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                        docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                            @Override
                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                if (task.isSuccessful()) {
                                                                                                                    DocumentSnapshot document = task.getResult();
                                                                                                                    if (document.exists()) {
                                                                                                                        if (!document.get("name").equals("")) {
                                                                                                                            fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                    get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                        @Override
                                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                            if (task.isSuccessful()) {
                                                                                                                                                ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                                                        .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                            @Override
                                                                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                                if (documentSnapshot.exists()) {
                                                                                                                                                                    ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                    ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                    ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                    System.out.println(textmonth + " " + y);
                                                                                                                                                                    int i = dayOfMonth;
                                                                                                                                                                    int counterthisholidays = 0;
                                                                                                                                                                    int counternextholidays = 0;
                                                                                                                                                                    int alreadybookednext = 0;
                                                                                                                                                                    int booknext = 0;
                                                                                                                                                                    int bookthis = 0;
                                                                                                                                                                    int alreadybooked = 0;
                                                                                                                                                                    int k = 1;
                                                                                                                                                                    int daysbookedthis;
                                                                                                                                                                    System.out.println(i + "uuu");
                                                                                                                                                                    while (i <= monthLastDate) {
                                                                                                                                                                        if (holidays != null) {
                                                                                                                                                                            if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println(i + "vvv");
                                                                                                                                                                                counterthisholidays++;
                                                                                                                                                                                System.out.println(counterthisholidays + "www");
                                                                                                                                                                            }
                                                                                                                                                                        }


                                                                                                                                                                        if (bookeddaysthismonth != null) {
                                                                                                                                                                            System.out.println("xxx");
                                                                                                                                                                            if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println("yyy");
                                                                                                                                                                                System.out.println(i);
                                                                                                                                                                                alreadybooked = 2;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                        if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                            bookthis = 1;
                                                                                                                                                                            System.out.println("aab");
                                                                                                                                                                            break;
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println("aac");

                                                                                                                                                                        i++;
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println(alreadybooked);
                                                                                                                                                                    System.out.println(bookthis);
                                                                                                                                                                    if (bookthis == 1) {
                                                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                                                        int counterholidaysnextnext = 0;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aacab"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println(("fb18 aacaba"));
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb19 aaab");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb20 aaaba");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        System.out.println("aaabba");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aaabbaa"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb21 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb22 aabbc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb23 aaabbb");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmeal");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println("f");
                                                                                                                                                                        System.out.println(counterthisholidays + "fa");
                                                                                                                                                                        System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                    }
                                                                                                                                                                    if (alreadybooked == 2) {
                                                                                                                                                                        System.out.println("already booked..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ga");

                                                                                                                                                                    }

                                                                                                                                                                    if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                        daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                                                        while (k <= monthLastDatenext) {

                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                System.out.println("aa");
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                    System.out.println("bb");
                                                                                                                                                                                    System.out.println(k + "c");
                                                                                                                                                                                    counternextholidays++;

                                                                                                                                                                                }
                                                                                                                                                                            }


                                                                                                                                                                            System.out.println(counternextholidays);

                                                                                                                                                                            if (bookeddaysnextmonth != null) {
                                                                                                                                                                                System.out.println("cc");
                                                                                                                                                                                if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                    alreadybookednext = 4;
                                                                                                                                                                                    System.out.println("dd");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                                booknext = 3;
                                                                                                                                                                                System.out.println("ee");
                                                                                                                                                                                System.out.println(k);

                                                                                                                                                                                break;
                                                                                                                                                                            }

                                                                                                                                                                            k++;


                                                                                                                                                                        }


                                                                                                                                                                    }

                                                                                                                                                                    if (booknext == 3) {
                                                                                                                                                                        {
                                                                                                                                                                            int counterholidaysnext = 0;
                                                                                                                                                                            int counterholidaysthis = 0;
                                                                                                                                                                            int counterholidaysnextnext = 0;

                                                                                                                                                                            System.out.println("not null not null");

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "abca"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb24 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb25 abcc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb26 abcdaa");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmealnext");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println(counternextholidays);
                                                                                                                                                                        System.out.println("ffa");
                                                                                                                                                                        System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                    }
                                                                                                                                                                    if (alreadybookednext == 4) {
                                                                                                                                                                        System.out.println("already booked next..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ggaa");
                                                                                                                                                                    }

                                                                                                                                                                }

                                                                                                                                                            }
                                                                                                                                                        });
                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                    });

                                                                                                                        } else {
                                                                                                                            AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                            alert.setTitle(" Please update Profile with address");
                                                                                                                            alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    if (document.exists()) {
                                                                                                                                        String phone = document.getString("phoneNo");
                                                                                                                                        Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                        intent.putExtra("phone", phone);
                                                                                                                                        startActivity(intent);
                                                                                                                                        finish();
                                                                                                                                    }
                                                                                                                                    ;
                                                                                                                                }
                                                                                                                            }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                    startActivity(intent);
                                                                                                                                    finish();
                                                                                                                                }
                                                                                                                            });
                                                                                                                            alert.show();

                                                                                                                        }
                                                                                                                    }
                                                                                                                }

                                                                                                            }
                                                                                                        });

                                                                                                    }
                                                                                                }

                                                                                            }

                                                                                        }

                                                                                    }
                                                                                });

                                                                            }

                                                                        }

                                                                    }
                                                                });
                                                            }

                                                        }
                                                    }

                                                } else {
                                                    if (!cbcustom.isChecked()) {

                                                        {
                                                            if (monthOfYear < 11) {
                                                                monthOfYearNext = monthOfYear + 1;
                                                                yearNext = year;
                                                            } else if (monthOfYear == 11) {
                                                                monthOfYearNext = 0;
                                                                yearNext = year + 1;

                                                            }
                                                            if (monthOfYear < 10) {
                                                                monthOfYearNextnext = monthOfYear + 2;
                                                                yearNextnext = year;
                                                            } else if (monthOfYear == 10) {
                                                                monthOfYearNextnext = 0;
                                                                yearNextnext = year + 1;

                                                            }

                                                            textmonth = MONTHS[monthOfYear];
                                                            textMonthnext = MONTHS[monthOfYearNext];
                                                            textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                            y = String.valueOf(year);
                                                            yn = String.valueOf(yearNext);
                                                            ynn = String.valueOf(yearNextnext);
                                                            tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                            t1 = c1.getTimeInMillis();
                                                            String y = String.valueOf(year);
                                                            Calendar c11 = Calendar.getInstance();
                                                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                            System.out.println(monthLastDatenext);
                                                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                            docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                @Override
                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                    if (task.isSuccessful()) {
                                                                        DocumentSnapshot document = task.getResult();
                                                                        if (document.exists()) {
                                                                            if (!document.get("name").equals("")) {
                                                                                fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                        get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                            @Override
                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                if (task.isSuccessful()) {
                                                                                                    ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                    ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                    ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                            .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                @Override
                                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                    DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                    if (documentSnapshot.exists()) {
                                                                                                                        ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                        ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                        ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                        System.out.println(textmonth + " " + y);
                                                                                                                        int i = dayOfMonth;
                                                                                                                        int counterthisholidays = 0;
                                                                                                                        int counternextholidays = 0;
                                                                                                                        int alreadybookednext = 0;
                                                                                                                        int booknext = 0;
                                                                                                                        int bookthis = 0;
                                                                                                                        int alreadybooked = 0;
                                                                                                                        int k = 1;
                                                                                                                        int daysbookedthis;
                                                                                                                        System.out.println(i + "aa");
                                                                                                                        System.out.println(monthLastDate + "aaabbb");


                                                                                                                        while (i <= monthLastDate) {
                                                                                                                            if (holidays != null) {

                                                                                                                                if (holidays.contains(String.valueOf(i))) {
                                                                                                                                    counterthisholidays++;
                                                                                                                                    System.out.println(i);
//
                                                                                                                                }


                                                                                                                            }

                                                                                                                            if (bookeddaysthismonth != null) {
                                                                                                                                System.out.println("dd");
                                                                                                                                if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                    System.out.println("ee");
                                                                                                                                    System.out.println(i);
                                                                                                                                    alreadybooked = 2;
                                                                                                                                    break;
                                                                                                                                }
                                                                                                                            }
                                                                                                                            System.out.println(counterthisholidays + "ff");
                                                                                                                            if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                bookthis = 1;
                                                                                                                                System.out.println("gg");
                                                                                                                                break;
                                                                                                                            }
                                                                                                                            System.out.println("hh");

                                                                                                                            i++;
                                                                                                                        }
                                                                                                                        System.out.println(alreadybooked + "ii");
                                                                                                                        System.out.println(bookthis + "jj");
                                                                                                                        if (bookthis == 1) {
                                                                                                                            int counterholidaysnext = 0;
                                                                                                                            int counterholidaysthis = 0;
                                                                                                                            int counterholidaysnextnext = 0;
                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                            {

                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                            counterholidaysthis++;
                                                                                                                                            System.out.println((counterholidaysthis + "kkb"));
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println((l + "kk"));

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println(("fb1 kka"));
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                }
                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                System.out.println(daysthismonth + "ll");
                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                int counternextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "mm");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb2 kkc");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextbook++;
                                                                                                                                }

                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                System.out.println(daysnextnext + "nn");
                                                                                                                                int counternextnextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "oo");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb3 ooa");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextnextbook++;

                                                                                                                                }

                                                                                                                            }
                                                                                                                            {

                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                            //counterholidaysthis++;
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println((counterholidaysthis + "ppa"));
                                                                                                                                    System.out.println((l + "pp"));

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println(("ppa1"));
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                }
                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                System.out.println(daysthismonth + "qq");
                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                int counternextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "rr");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb4 ss");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextbook++;
                                                                                                                                }

                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                System.out.println(daysnextnext);
                                                                                                                                int counternextnextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "tt");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println(" fb5 uu");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextnextbook++;

                                                                                                                                }

                                                                                                                            }

                                                                                                                            System.out.println("..bookmeal");
                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                            System.out.println("vv");
                                                                                                                            System.out.println(counterthisholidays + "vva");
                                                                                                                            System.out.println(i - counterthisholidays + "vvaa");

                                                                                                                        }

                                                                                                                        if (alreadybooked == 2) {
                                                                                                                            System.out.println("already booked..");
                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                            System.out.println("ww");

                                                                                                                        }

                                                                                                                        if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                            daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                            while (k <= monthLastDatenext) {

//
                                                                                                                                if (holidaysnext != null) {
                                                                                                                                    System.out.println("aaa");
                                                                                                                                    if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                        System.out.println("bbb");
                                                                                                                                        System.out.println(k + "ccc");
                                                                                                                                        counternextholidays++;

                                                                                                                                    }
                                                                                                                                }


                                                                                                                                System.out.println(counternextholidays);

                                                                                                                                if (bookeddaysnextmonth != null) {
                                                                                                                                    System.out.println("ddd");
                                                                                                                                    if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                        alreadybookednext = 4;
                                                                                                                                        System.out.println("eee");
                                                                                                                                        System.out.println(k);

                                                                                                                                        break;

                                                                                                                                    }

                                                                                                                                }
                                                                                                                                if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                    booknext = 3;
                                                                                                                                    System.out.println("fff");
                                                                                                                                    System.out.println(k);

                                                                                                                                    break;
                                                                                                                                }

                                                                                                                                k++;


                                                                                                                            }


                                                                                                                        }

                                                                                                                        if (booknext == 3) {
                                                                                                                            {
                                                                                                                                int counterholidaysnext = 0;
                                                                                                                                int counterholidaysthis = 0;
                                                                                                                                int counterholidaysnextnext = 0;

                                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                                            counterholidaysthis++;
                                                                                                                                            System.out.println("wwa");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println((l + "ggg"));

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb6 ss");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                }
                                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                System.out.println(daysthismonth + "hhh");
                                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                                int counternextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnext != null) {
                                                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "iii");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb7 jjj");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextbook++;
                                                                                                                                }

                                                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                System.out.println(daysnextnext + "kkk");
                                                                                                                                int counternextnextbook = 0;
                                                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    if (holidaysnextnext != null) {
                                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                            counterholidaysnextnext++;
                                                                                                                                            System.out.println(counterholidaysnext + "lll");
                                                                                                                                            continue;
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                @Override
                                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                                    System.out.println("fb8 mmm");
                                                                                                                                                }
                                                                                                                                            })
                                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                @Override
                                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                    counternextnextbook++;

                                                                                                                                }

                                                                                                                            }

                                                                                                                            System.out.println("..bookmealnext");
                                                                                                                            alertDialogSuccessfulBooking();
                                                                                                                            System.out.println(counternextholidays + "nnn");
                                                                                                                            System.out.println("ooo");
                                                                                                                            System.out.println(k - counternextholidays + "ppp");
                                                                                                                        }
                                                                                                                        if (alreadybookednext == 4) {
                                                                                                                            System.out.println("already booked next..");
                                                                                                                            alertDialogAlreadyBooked();
                                                                                                                            System.out.println("qqq");
                                                                                                                        }

                                                                                                                    }

                                                                                                                }
                                                                                                            });
                                                                                                }

                                                                                            }
                                                                                        });

                                                                            } else {
                                                                                AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                alert.setTitle(" Please update Profile with address");
                                                                                alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                    @Override
                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                        if (document.exists()) {
                                                                                            String phone = document.getString("phoneNo");
                                                                                            Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                            intent.putExtra("phone", phone);
                                                                                            startActivity(intent);
                                                                                            finish();
                                                                                        }
                                                                                    }
                                                                                }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                    @Override
                                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                                        Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                        startActivity(intent);
                                                                                        finish();
                                                                                    }
                                                                                });
                                                                                alert.show();

                                                                            }
                                                                        }
                                                                    }

                                                                }
                                                            });

                                                        }

                                                    }
                                                    else {
                                                        //addMealCustomPlan(days, meal);
                                                        {
                                                            DocumentReference documentReference = fstore.collection("users").document(userID).collection("events").document("dinner");
                                                            documentReference.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                @Override
                                                                public void onComplete(Task<DocumentSnapshot> task) {
                                                                    if (task.isSuccessful()) {
                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                        if (documentSnapshot != null) {
                                                                            Map<String, Object> map = documentSnapshot.getData();
                                                                            fieldSizeDinner = map.size();
                                                                            System.out.println("....++" + fieldSizeDinner);
                                                                            DocumentReference documentReference1 = fstore.collection("users").document(userID).collection("events").document("lunch");
                                                                            documentReference1.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                @Override
                                                                                public void onComplete(Task<DocumentSnapshot> task) {
                                                                                    if (task.isSuccessful()) {
                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                        if (documentSnapshot != null) {
                                                                                            Map<String, Object> map = documentSnapshot.getData();
                                                                                            fieldSizeLunch = map.size();
                                                                                            System.out.println("....++" + fieldSizeDinner);
                                                                                            System.out.println("sss.." + fieldSizeLunch + "ttt.." + fieldSizeDinner);
                                                                                            if (fieldSizeDinner < 2 && fieldSizeLunch < 2) {


                                                                                                if (a < 7) {
                                                                                                    AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                    alert.setTitle(" First time Booking");
                                                                                                    alert.setMessage("First time booking, minimum 7 days required !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                                                                                                        @Override
                                                                                                        public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                            cbcustom.setChecked(false);
                                                                                                            //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                                                        }
                                                                                                    }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                                                                                                        @Override
                                                                                                        public void onClick(DialogInterface dialogInterface, int i) {

                                                                                                        }
                                                                                                    });
                                                                                                    alert.show();
                                                                                                } else {
                                                                                                    System.out.println("ttta");

                                                                                                    if (monthOfYear < 11) {
                                                                                                        monthOfYearNext = monthOfYear + 1;
                                                                                                        yearNext = year;
                                                                                                    } else if (monthOfYear == 11) {
                                                                                                        monthOfYearNext = 0;
                                                                                                        yearNext = year + 1;

                                                                                                    }
                                                                                                    if (monthOfYear < 10) {
                                                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                                                        yearNextnext = year;
                                                                                                    } else if (monthOfYear == 10) {
                                                                                                        monthOfYearNextnext = 0;
                                                                                                        yearNextnext = year + 1;

                                                                                                    }

                                                                                                    textmonth = MONTHS[monthOfYear];
                                                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                    y = String.valueOf(year);
                                                                                                    yn = String.valueOf(yearNext);
                                                                                                    ynn = String.valueOf(yearNextnext);
                                                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                    t1 = c1.getTimeInMillis();
                                                                                                    String y = String.valueOf(year);
                                                                                                    Calendar c11 = Calendar.getInstance();
                                                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                    System.out.println(monthLastDatenext);

                                                                                                    FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                        @Override
                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                            if (task.isSuccessful()) {
                                                                                                                DocumentSnapshot document = task.getResult();
                                                                                                                if (document.exists()) {
                                                                                                                    if (!document.get("name").equals("")) {
                                                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                    @Override
                                                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                        if (task.isSuccessful()) {
                                                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                                                int i = dayOfMonth;
                                                                                                                                                                int counterthisholidays = 0;
                                                                                                                                                                int counternextholidays = 0;
                                                                                                                                                                int alreadybookednext = 0;
                                                                                                                                                                int booknext = 0;
                                                                                                                                                                int bookthis = 0;
                                                                                                                                                                int alreadybooked = 0;
                                                                                                                                                                int k = 1;
                                                                                                                                                                int daysbookedthis;
                                                                                                                                                                System.out.println(i + "uuu");
                                                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                            System.out.println(i + "vvv");
                                                                                                                                                                            counterthisholidays++;
                                                                                                                                                                            System.out.println(counterthisholidays + "www");
                                                                                                                                                                        }
                                                                                                                                                                    }

                                                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                                                        System.out.println("xxx");
                                                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                            System.out.println("yyy");
                                                                                                                                                                            System.out.println(i);
                                                                                                                                                                            alreadybooked = 2;
                                                                                                                                                                            break;
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                        bookthis = 1;
                                                                                                                                                                        System.out.println("aab");
                                                                                                                                                                        break;
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println("aac");

                                                                                                                                                                    i++;
                                                                                                                                                                }
                                                                                                                                                                System.out.println(alreadybooked);
                                                                                                                                                                System.out.println(bookthis);
                                                                                                                                                                if (bookthis == 1) {
                                                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                    {

                                                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                                                    System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println((l + "aacab"));

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println(("fb9 aacaba"));
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                        }
                                                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        int counternextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb10 aaab");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextbook++;
                                                                                                                                                                        }

                                                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb11 aaaba");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextnextbook++;

                                                                                                                                                                        }

                                                                                                                                                                    }
                                                                                                                                                                    {

                                                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(l))) {

                                                                                                                                                                                    System.out.println("aaabba");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println((l + "aaabbaa"));

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb12 ss");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                        }
                                                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        int counternextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb13 aabbc");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextbook++;
                                                                                                                                                                        }

                                                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb14 aaabbb");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextnextbook++;

                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                                                    System.out.println("f");
                                                                                                                                                                    System.out.println(counterthisholidays + "fa");
                                                                                                                                                                    System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                }
                                                                                                                                                                if (alreadybooked == 2) {
                                                                                                                                                                    System.out.println("already booked..");
                                                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                                                    System.out.println("ga");

                                                                                                                                                                }

                                                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                                                    while (k <= monthLastDatenext) {

//
                                                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                                                            System.out.println("aa");
                                                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                System.out.println("bb");
                                                                                                                                                                                System.out.println(k + "c");
                                                                                                                                                                                counternextholidays++;

                                                                                                                                                                            }
                                                                                                                                                                        }


                                                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                                                            System.out.println("cc");
                                                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                                                System.out.println("dd");
                                                                                                                                                                                System.out.println(k);

                                                                                                                                                                                break;

                                                                                                                                                                            }

                                                                                                                                                                        }
                                                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                            booknext = 3;
                                                                                                                                                                            System.out.println("ee");
                                                                                                                                                                            System.out.println(k);

                                                                                                                                                                            break;
                                                                                                                                                                        }

                                                                                                                                                                        k++;


                                                                                                                                                                    }


                                                                                                                                                                }

                                                                                                                                                                if (booknext == 3) {
                                                                                                                                                                    {
                                                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                                                        System.out.println("not null not null");

                                                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                                                    System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println((l + "abca"));

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb15 ss");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                        }
                                                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        int counternextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb16 abcc");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextbook++;
                                                                                                                                                                        }

                                                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb17 abcdaa");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextnextbook++;

                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                                                    System.out.println(counternextholidays);
                                                                                                                                                                    System.out.println("ffa");
                                                                                                                                                                    System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                }
                                                                                                                                                                if (alreadybookednext == 4) {
                                                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                                                    System.out.println("ggaa");
                                                                                                                                                                }

                                                                                                                                                            }

                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                });

                                                                                                                    } else {
                                                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                            @Override
                                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                if (document.exists()) {
                                                                                                                                    String phone = document.getString("phoneNo");
                                                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                    intent.putExtra("phone", phone);
                                                                                                                                    startActivity(intent);
                                                                                                                                    finish();
                                                                                                                                }
                                                                                                                            }
                                                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                            @Override
                                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                startActivity(intent);
                                                                                                                                finish();
                                                                                                                            }
                                                                                                                        });
                                                                                                                        alert.show();

                                                                                                                    }
                                                                                                                }
                                                                                                            }

                                                                                                        }
                                                                                                    });

                                                                                                }
                                                                                            } else {
                                                                                                {
                                                                                                    System.out.println("ttta");

                                                                                                    if (monthOfYear < 11) {
                                                                                                        monthOfYearNext = monthOfYear + 1;
                                                                                                        yearNext = year;
                                                                                                    } else if (monthOfYear == 11) {
                                                                                                        monthOfYearNext = 0;
                                                                                                        yearNext = year + 1;

                                                                                                    }
                                                                                                    if (monthOfYear < 10) {
                                                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                                                        yearNextnext = year;
                                                                                                    } else if (monthOfYear == 10) {
                                                                                                        monthOfYearNextnext = 0;
                                                                                                        yearNextnext = year + 1;

                                                                                                    }

                                                                                                    textmonth = MONTHS[monthOfYear];
                                                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                    y = String.valueOf(year);
                                                                                                    yn = String.valueOf(yearNext);
                                                                                                    ynn = String.valueOf(yearNextnext);
                                                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                    t1 = c1.getTimeInMillis();
                                                                                                    String y = String.valueOf(year);
                                                                                                    Calendar c11 = Calendar.getInstance();
                                                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                    System.out.println(monthLastDatenext);

                                                                                                    FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                        @Override
                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                            if (task.isSuccessful()) {
                                                                                                                DocumentSnapshot document = task.getResult();
                                                                                                                if (document.exists()) {
                                                                                                                    if (!document.get("name").equals("")) {
                                                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                    @Override
                                                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                        if (task.isSuccessful()) {
                                                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                                                int i = dayOfMonth;
                                                                                                                                                                int counterthisholidays = 0;
                                                                                                                                                                int counternextholidays = 0;
                                                                                                                                                                int alreadybookednext = 0;
                                                                                                                                                                int booknext = 0;
                                                                                                                                                                int bookthis = 0;
                                                                                                                                                                int alreadybooked = 0;
                                                                                                                                                                int k = 1;
                                                                                                                                                                int daysbookedthis;
                                                                                                                                                                System.out.println(i + "uuu");
                                                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                                                    if (holidays != null) {
                                                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                            System.out.println(i + "vvv");
                                                                                                                                                                            counterthisholidays++;
                                                                                                                                                                            System.out.println(counterthisholidays + "www");
                                                                                                                                                                        }
                                                                                                                                                                    }


                                                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                                                        System.out.println("xxx");
                                                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                            System.out.println("yyy");
                                                                                                                                                                            System.out.println(i);
                                                                                                                                                                            alreadybooked = 2;
                                                                                                                                                                            break;
                                                                                                                                                                        }
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                        bookthis = 1;
                                                                                                                                                                        System.out.println("aab");
                                                                                                                                                                        break;
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println("aac");

                                                                                                                                                                    i++;
                                                                                                                                                                }
                                                                                                                                                                System.out.println(alreadybooked);
                                                                                                                                                                System.out.println(bookthis);
                                                                                                                                                                if (bookthis == 1) {
                                                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                    {

                                                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                                                    System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println((l + "aacab"));

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println(("fb18 aacaba"));
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                        }
                                                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        int counternextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb19 aaab");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextbook++;
                                                                                                                                                                        }

                                                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb20 aaaba");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextnextbook++;

                                                                                                                                                                        }

                                                                                                                                                                    }
                                                                                                                                                                    {

                                                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                    System.out.println("aaabba");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println((l + "aaabbaa"));

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb21 ss");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                        }
                                                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        int counternextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb22 aabbc");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextbook++;
                                                                                                                                                                        }

                                                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb23 aaabbb");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextnextbook++;

                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                                                    System.out.println("f");
                                                                                                                                                                    System.out.println(counterthisholidays + "fa");
                                                                                                                                                                    System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                }
                                                                                                                                                                if (alreadybooked == 2) {
                                                                                                                                                                    System.out.println("already booked..");
                                                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                                                    System.out.println("ga");

                                                                                                                                                                }

                                                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                                                    while (k <= monthLastDatenext) {

                                                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                                                            System.out.println("aa");
                                                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                System.out.println("bb");
                                                                                                                                                                                System.out.println(k + "c");
                                                                                                                                                                                counternextholidays++;

                                                                                                                                                                            }
                                                                                                                                                                        }


                                                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                                                            System.out.println("cc");
                                                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                                                System.out.println("dd");
                                                                                                                                                                                System.out.println(k);

                                                                                                                                                                                break;

                                                                                                                                                                            }

                                                                                                                                                                        }
                                                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                            booknext = 3;
                                                                                                                                                                            System.out.println("ee");
                                                                                                                                                                            System.out.println(k);

                                                                                                                                                                            break;
                                                                                                                                                                        }

                                                                                                                                                                        k++;


                                                                                                                                                                    }


                                                                                                                                                                }

                                                                                                                                                                if (booknext == 3) {
                                                                                                                                                                    {
                                                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                                                        System.out.println("not null not null");

                                                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidays != null) {
                                                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                                                    System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            System.out.println((l + "abca"));

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb24 ss");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                        }
                                                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        int counternextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }
                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb25 abcc");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextbook++;
                                                                                                                                                                        }

                                                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                                                    System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                    continue;
                                                                                                                                                                                }
                                                                                                                                                                            }

                                                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                                                            System.out.println("fb26 abcdaa");
                                                                                                                                                                                        }
                                                                                                                                                                                    })
                                                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                        @Override
                                                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                            counternextnextbook++;

                                                                                                                                                                        }

                                                                                                                                                                    }

                                                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                                                    System.out.println(counternextholidays);
                                                                                                                                                                    System.out.println("ffa");
                                                                                                                                                                    System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                }
                                                                                                                                                                if (alreadybookednext == 4) {
                                                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                                                    System.out.println("ggaa");
                                                                                                                                                                }

                                                                                                                                                            }

                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                });

                                                                                                                    } else {
                                                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                            @Override
                                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                if (document.exists()) {
                                                                                                                                    String phone = document.getString("phoneNo");
                                                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                    intent.putExtra("phone", phone);
                                                                                                                                    startActivity(intent);
                                                                                                                                    finish();
                                                                                                                                }
                                                                                                                                ;
                                                                                                                            }
                                                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                            @Override
                                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                startActivity(intent);
                                                                                                                                finish();
                                                                                                                            }
                                                                                                                        });
                                                                                                                        alert.show();

                                                                                                                    }
                                                                                                                }
                                                                                                            }

                                                                                                        }
                                                                                                    });

                                                                                                }
                                                                                            }

                                                                                        }

                                                                                    }

                                                                                }
                                                                            });

                                                                        }

                                                                    }

                                                                }
                                                            });
                                                        }
                                                    }
                                                }
                                            }
                                        }

                                    }
                                });
                    }
                },
                year, month, day);
        long today = c1.getTimeInMillis();
        final long oneDay = 24 * 60 * 60 * 1000L;

        datePickerDialog.getDatePicker().setMinDate(today+oneDay);
        String da=String.valueOf(datePickerDialog.getDatePicker().getDayOfMonth());

        datePickerDialog.getDatePicker().setMaxDate(today + 90 * oneDay);
        //Date nextMonth = new Date(today + 30 * oneDay);
        //Date previousDays = new Date(today - 1000);
        /*Calendar today = Calendar.getInstance();
        Calendar twoDaysAgo = (Calendar) today.clone();
        twoDaysAgo.add(Calendar.DATE, -2);
        Calendar twoDaysLater = (Calendar) today.clone();
        twoDaysLater.add(Calendar.DATE, 2);*/
        //datePickerDialog.getDatePicker().setMinDate(System.currentTimeMillis() - 1000);
        // at last we are calling show to
        // display our date picker dialog.
        //Toast.makeText(this, "show2", Toast.LENGTH_SHORT).show();
        datePickerDialog.show();

    }
    public void checkAndAddLunchDinner(int days,String meal1,String meal2)
    {
        final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

        final Calendar c1 = Calendar.getInstance();

        // on below line we are getting
        // our day, month and year.
        int year = c1.get(Calendar.YEAR);
        int month = c1.get(Calendar.MONTH);
        int day = c1.get(Calendar.DAY_OF_MONTH);




        // on below line we are creating a variable for date picker dialog.
        DatePickerDialog datePickerDialog = new DatePickerDialog(
                // on below line we are passing context.
                DatePicker1.this,
                new DatePickerDialog.OnDateSetListener() {
                    @Override
                    public void onDateSet(DatePicker view, int year,
                                          int monthOfYear, int dayOfMonth)
                    {

                        if(monthOfYear<11){
                            monthOfYearNext=monthOfYear+1;
                            yearNext=year;
                        } else if (monthOfYear==11) {
                            monthOfYearNext=0;
                            yearNext=year+1;

                        }
                        if(monthOfYear<10){
                            monthOfYearNextnext=monthOfYear+2;
                            yearNextnext=year;
                        } else if (monthOfYear==10) {
                            monthOfYearNextnext=0;
                            yearNextnext=year+1;

                        }

                        textmonth=MONTHS[monthOfYear];
                        textMonthnext=MONTHS[monthOfYearNext];
                        textMonthnextnext=MONTHS[monthOfYearNextnext];
                        y=String.valueOf(year);
                        yn=String.valueOf(yearNext);
                        ynn=String.valueOf(yearNextnext);
                        tvinitialdate.setText("Initial Booking Date: "+dayOfMonth+"/"+(monthOfYear+1)+"/"+year);
                        t1 = c1.getTimeInMillis();
                        String y = String.valueOf(year);
                        Calendar c11=Calendar.getInstance();
                        Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                        int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                        Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                        int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                        Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                        int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                        System.out.println(monthLastDatenext);
                        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                        DocumentReference docIdRef = firestore.collection("users").document(userID);
                        docIdRef.collection("events").document(meal2).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                            @Override
                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                DocumentSnapshot documentSnapshot=task.getResult();
                                if(documentSnapshot.exists()){
                                    ArrayList<String> bookeddaysthismonth1 = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                    ArrayList<String> bookeddaysnextmonth1 = (ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                    ArrayList<String> bookeddaysnextnextmonth1 = (ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                        if(!cbcustom.isChecked())
                        {

                                        docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                            @Override
                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                if (task.isSuccessful()){
                                                    DocumentSnapshot document = task.getResult();
                                                    if (document.exists()){
                                                        if (!document.get("name").equals(""))
                                                        {
                                                            fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                    get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                            DocumentSnapshot documentSnapshot=task.getResult();
                                                                            if(task.isSuccessful()){
                                                                                ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                                                                ArrayList<String>holidaysnext=(ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                                                                ArrayList<String>holidaysnextnext=(ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                                                                                fstore.collection("users").document(userID).collection("events").document(meal1).get()
                                                                                        .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                            @Override
                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                DocumentSnapshot documentSnapshot=task.getResult();
                                                                                                if(documentSnapshot.exists()){
                                                                                                    ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                                                                                    ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                                                                                    ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                                                                                                    System.out.println(textmonth+" "+y);
                                                                                                    int i = dayOfMonth;
                                                                                                    int counterthisholidays = 0;
                                                                                                    int counternextholidays=0;
                                                                                                    int alreadybookednext=0;
                                                                                                    int booknext=0;
                                                                                                    int bookthis=0;
                                                                                                    int alreadybooked=0;
                                                                                                    int k=1;
                                                                                                    int daysbookedthis;
                                                                                                    System.out.println(i+"aa");
                                                                                                    System.out.println(monthLastDate+"aaabbb");


                                                                                                    while (i <= monthLastDate) {
                                                                                                        if(holidays!=null){

                                                                                                            if(holidays.contains(String.valueOf(i))){
                                                                                                                counterthisholidays++;
                                                                                                                System.out.println(i);
//                                                                                                    System.out.println(i+"bb");

//                                                                                                    System.out.println(counterthisholidays+"cc");
//                                                                                                    continue;
                                                                                                            }


                                                                                                        }

                                                                                                        if(bookeddaysthismonth!=null){
                                                                                                            System.out.println("dd");
                                                                                                            if(bookeddaysthismonth.contains(String.valueOf(i))){
                                                                                                                System.out.println("ee");
                                                                                                                System.out.println(i);
                                                                                                                alreadybooked=2;
                                                                                                                break;
                                                                                                            }
                                                                                                        }
                                                                                                        if(bookeddaysthismonth1!=null){
                                                                                                            System.out.println("dd1");
                                                                                                            if(bookeddaysthismonth1.contains(String.valueOf(i))){
                                                                                                                System.out.println("ee1");
                                                                                                                System.out.println(i);
                                                                                                                alreadybooked1=2;
                                                                                                                break;
                                                                                                            }
                                                                                                        }
                                                                                                        System.out.println(counterthisholidays+"ff1");
                                                                                                        if(i-dayOfMonth-counterthisholidays==days-1){
                                                                                                            bookthis=1;
                                                                                                            System.out.println("gg1");
                                                                                                            break;
                                                                                                        }
                                                                                                        System.out.println("hh1");

                                                                                                        i++;
                                                                                                    }
                                                                                                    System.out.println(alreadybooked+"ii");
                                                                                                    System.out.println(bookthis+"jj");
                                                                                                    if(monthLastDate-dayOfMonth-counterthisholidays+1<days)
                                                                                                    {

                                                                                                        daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;
                                                                                                        //System.out.println(daysbookedthis);
                                                                                                        //System.out.println(counterthisholidays);

                                                                                                        while (k <= monthLastDatenext) {

//                                                                                            while (k<days-daysbookedthis+counternextholidays+1) {
                                                                                                            //while (k<monthLastDatenext) {
                                                                                                            if (holidaysnext != null) {
                                                                                                                System.out.println("aaa");
                                                                                                                if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                    System.out.println("bbb");
                                                                                                                    System.out.println(k + "ccc");
                                                                                                                    counternextholidays++;

                                                                                                                }
                                                                                                            }
                                                                                                            //System.out.println(holidaysnext.size() + "b");


                                                                                                            System.out.println(counternextholidays);

                                                                                                            if (bookeddaysnextmonth != null) {
                                                                                                                System.out.println("ddd");
                                                                                                                if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                    alreadybookednext = 4;
                                                                                                                    System.out.println("eee");
                                                                                                                    System.out.println(k);

                                                                                                                    break;

                                                                                                                }

                                                                                                            }
                                                                                                            if (bookeddaysnextmonth1 != null) {
                                                                                                                System.out.println("ddd");
                                                                                                                if (bookeddaysnextmonth1.contains(String.valueOf(k))) {
                                                                                                                    alreadybookednext1 = 4;
                                                                                                                    System.out.println("eee");
                                                                                                                    System.out.println(k);

                                                                                                                    break;

                                                                                                                }

                                                                                                            }
                                                                                                            if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                booknext = 3;
                                                                                                                System.out.println("fff");
                                                                                                                System.out.println(k);

                                                                                                                break;
                                                                                                            }

                                                                                                            k++;


                                                                                                        }


                                                                                                    }
                                                                                                    if(alreadybooked==2|| alreadybooked1==2||alreadybookednext == 4 ||alreadybookednext1 == 4)
                                                                                                    {
                                                                                                        System.out.println("already booked..all this");
                                                                                                        alertDialogAlreadyBooked();
                                                                                                        System.out.println("ww");
                                                                                                    }
                                                                                                     else if(bookthis==1)
                                                                                                    {
                                                                                                        int counterholidaysnext=0;
                                                                                                        int counterholidaysthis = 0;
                                                                                                        int counterholidaysnextnext=0;
                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                        {

                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidays !=null){
                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                        counterholidaysthis++;
                                                                                                                        System.out.println((counterholidaysthis+"kkb"));
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }
                                                                                                                System.out.println((l+"kk"));

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println(("fb1 kka"));
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println(("fb1 kka"));
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                            }
                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                            System.out.println(daysthismonth+"ll");
                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                            int counternextbook=0;
                                                                                                            for (int p = 1; p < daysnextmonth + 1+counterholidaysnext; p++) {
                                                                                                                if(p==monthLastDatenext +1){
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidaysnext !=null){
                                                                                                                    if(holidaysnext.contains(String.valueOf(p))) {
                                                                                                                        counterholidaysnext++;
                                                                                                                        System.out.println(counterholidaysnext+"mm");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb2 kkc");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb2 kkc");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                counternextbook++;
                                                                                                            }

                                                                                                            int daysnextnext=days-daysthismonth-counternextbook;
                                                                                                            System.out.println(daysnextnext+"nn");
                                                                                                            int counternextnextbook=0;
                                                                                                            for (int p = 1; p < daysnextnext + 1+counterholidaysnextnext; p++) {
                                                                                                                if(p==monthLastDatenextnext +1){
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidaysnextnext!=null) {
                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                        counterholidaysnextnext++;
                                                                                                                        System.out.println(counterholidaysnext + "oo");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb3 ooa");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb3 ooa");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                counternextnextbook++;

                                                                                                            }

                                                                                                        }
                                                                                                        {

                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidays !=null){
                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                        //counterholidaysthis++;
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }
                                                                                                                System.out.println((counterholidaysthis+"ppa"));
                                                                                                                System.out.println((l+"pp"));

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println(("ppa1"));
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println(("ppa1"));
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                            }
                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                            System.out.println(daysthismonth+"qq");
                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                            int counternextbook=0;
                                                                                                            for (int p = 1; p < daysnextmonth + 1+counterholidaysnext; p++) {
                                                                                                                if(p==monthLastDatenext +1){
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidaysnext !=null){
                                                                                                                    if(holidaysnext.contains(String.valueOf(p))) {
                                                                                                                        counterholidaysnext++;
                                                                                                                        System.out.println(counterholidaysnext+"rr");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb4 ss");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb4 ss");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                counternextbook++;
                                                                                                            }

                                                                                                            int daysnextnext=days-daysthismonth-counternextbook;
                                                                                                            System.out.println(daysnextnext);
                                                                                                            int counternextnextbook=0;
                                                                                                            for (int p = 1; p < daysnextnext + 1+counterholidaysnextnext; p++) {
                                                                                                                if(p==monthLastDatenextnext +1){
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidaysnextnext!=null) {
                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                        counterholidaysnextnext++;
                                                                                                                        System.out.println(counterholidaysnext + "tt");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println( " fb5 uu");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println( " fb5 uu");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                counternextnextbook++;

                                                                                                            }

                                                                                                        }

                                                                                                        System.out.println("..bookmeal");
                                                                                                        alertDialogSuccessfulBooking();
                                                                                                        System.out.println("vv");
                                                                                                        System.out.println(counterthisholidays+"vva");
                                                                                                        System.out.println(i-counterthisholidays+"vvaa");

                                                                                                    }
                                                                                                    else if (booknext ==3)
                                                                                                    {
                                                                                                        {
                                                                                                            int counterholidaysnext=0;
                                                                                                            int counterholidaysthis = 0;
                                                                                                            int counterholidaysnextnext=0;

                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidays !=null){
                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                        counterholidaysthis++;
                                                                                                                        System.out.println("wwa");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }
                                                                                                                System.out.println((l+"ggg"));

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb6 ss");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb6 ss");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                            }
                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                            System.out.println(daysthismonth+"hhh");
                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                            int counternextbook=0;
                                                                                                            for (int p = 1; p < daysnextmonth + 1+counterholidaysnext; p++) {
                                                                                                                if(p==monthLastDatenext +1){
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidaysnext !=null){
                                                                                                                    if(holidaysnext.contains(String.valueOf(p))) {
                                                                                                                        counterholidaysnext++;
                                                                                                                        System.out.println(counterholidaysnext+"iii");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb7 jjj");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb7 jjj");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                counternextbook++;
                                                                                                            }

                                                                                                            int daysnextnext=days-daysthismonth-counternextbook;
                                                                                                            System.out.println(daysnextnext+"kkk");
                                                                                                            int counternextnextbook=0;
                                                                                                            for (int p = 1; p < daysnextnext + 1+counterholidaysnextnext; p++) {
                                                                                                                if(p==monthLastDatenextnext +1){
                                                                                                                    break;
                                                                                                                }
                                                                                                                if(holidaysnextnext!=null) {
                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                        counterholidaysnextnext++;
                                                                                                                        System.out.println(counterholidaysnext + "lll");
                                                                                                                        continue;
                                                                                                                    }
                                                                                                                }

                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb8 mmm");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                            @Override
                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                System.out.println("fb8 mmm");
                                                                                                                            }
                                                                                                                        })
                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                            @Override
                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                            }
                                                                                                                        });
                                                                                                                counternextnextbook++;

                                                                                                            }

                                                                                                        }

                                                                                                        System.out.println("..bookmealnext");
                                                                                                        alertDialogSuccessfulBooking();
                                                                                                        System.out.println(counternextholidays+"nnn");
                                                                                                        System.out.println("ooo");
                                                                                                        System.out.println(k - counternextholidays+"ppp");
                                                                                                    }

                                                                                                }

                                                                                            }
                                                                                        });
                                                                            }

                                                                        }
                                                                    });

                                                        } else
                                                        {
                                                            AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                            alert.setTitle(" Please update Profile with address");
                                                            alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                @Override
                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                    if (document.exists()) {
                                                                        String phone= document.getString("phoneNo");
                                                                        //Toast.makeText(CustomCalendar.this, phone, Toast.LENGTH_SHORT).show();
                                                                        Intent intent=new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                        intent.putExtra("phone",phone);
                                                                        startActivity(intent);
                                                                        finish();
                                                                    }
//                                    Intent intent=new Intent(CustomCalendar.this, OtpUpdateProfile.class);
//                            startActivity(intent);
                                                                    //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                }
                                                            }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                @Override
                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                    Intent intent=new Intent(DatePicker1.this, MainActivity.class);
                                                                    startActivity(intent);
                                                                    finish();
                                                                }
                                                            });
                                                            alert.show();

                                                        }
                                                    }
                                                }

                                            }
                                        });



                            //FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                            //DocumentReference docIdRef = firestore.collection("users").document(userID);


                        }
                        else
                        {
                            DocumentReference documentReference=fstore.collection("users").document(userID).collection("events").document(meal1);
                            documentReference  .get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                @Override
                                public void onComplete(Task<DocumentSnapshot> task) {
                                    if(task.isSuccessful()){
                                        DocumentSnapshot documentSnapshot=task.getResult();
                                        if(documentSnapshot !=null){
                                            Map<String, Object> map=documentSnapshot.getData();
                                            fieldSizeDinner=map.size();
                                            System.out.println("....++"+fieldSizeDinner);
                                            DocumentReference documentReference1=fstore.collection("users").document(userID).collection("events").document(meal2);
                                            documentReference1  .get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                @Override
                                                public void onComplete(Task<DocumentSnapshot> task) {
                                                    if(task.isSuccessful()){
                                                        DocumentSnapshot documentSnapshot=task.getResult();
                                                        if(documentSnapshot !=null) {
                                                            Map<String, Object> map = documentSnapshot.getData();
                                                            fieldSizeLunch = map.size();
                                                            System.out.println("....++" + fieldSizeDinner);
                                                            System.out.println("sss.." + fieldSizeLunch + "ttt.." + fieldSizeDinner);
                                                            //System.out.println("value of a:"+a);
                                                            if (fieldSizeDinner < 2 && fieldSizeLunch < 2) {


                                                                if (a < 7)
                                                                {
                                                                    //Toast.makeText(CustomCalendar.this, "First time minimum 7 day booking allowed", Toast.LENGTH_SHORT).show();
                                                                    AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                    alert.setTitle(" First time Booking");
                                                                    alert.setMessage("First time booking, minimum 7 days required !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                                                                        @Override
                                                                        public void onClick(DialogInterface dialogInterface, int i) {
                                                                            cbcustom.setChecked(false);
                                                                            //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                        }
                                                                    }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                                                                        @Override
                                                                        public void onClick(DialogInterface dialogInterface, int i) {

                                                                        }
                                                                    });
                                                                    alert.show();
                                                                }
                                                                else
                                                                {
                                                                    System.out.println("ttta");

                                                                    if (monthOfYear < 11) {
                                                                        monthOfYearNext = monthOfYear + 1;
                                                                        yearNext = year;
                                                                    } else if (monthOfYear == 11) {
                                                                        monthOfYearNext = 0;
                                                                        yearNext = year + 1;

                                                                    }
                                                                    if (monthOfYear < 10) {
                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                        yearNextnext = year;
                                                                    } else if (monthOfYear == 10) {
                                                                        monthOfYearNextnext = 0;
                                                                        yearNextnext = year + 1;

                                                                    }

                                                                    textmonth = MONTHS[monthOfYear];
                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                    //y = String.valueOf(year);
                                                                    yn = String.valueOf(yearNext);
                                                                    ynn = String.valueOf(yearNextnext);
                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                    t1 = c1.getTimeInMillis();
                                                                    String y = String.valueOf(year);
                                                                    Calendar c11 = Calendar.getInstance();
                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    System.out.println(monthLastDatenext);
                                                                    FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                            if (task.isSuccessful()) {
                                                                                DocumentSnapshot document = task.getResult();
                                                                                if (document.exists()) {
                                                                                    if (!document.get("name").equals("")) {
                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                    @Override
                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                        if (task.isSuccessful()) {
                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1).get()
                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                        @Override
                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                //System.out.println("kll"+bookeddaysthismonth.get(0));
                                                                                                                                int i = dayOfMonth;
                                                                                                                                int counterthisholidays = 0;
                                                                                                                                int counternextholidays = 0;
                                                                                                                                int alreadybookednext = 0;
                                                                                                                                int booknext = 0;
                                                                                                                                int bookthis = 0;
                                                                                                                                int alreadybooked = 0;
                                                                                                                                int k = 1;
                                                                                                                                int daysbookedthis;
                                                                                                                                System.out.println(i + "uuu");
                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println(i + "vvv");
                                                                                                                                            counterthisholidays++;
                                                                                                                                            System.out.println(counterthisholidays + "www");
                                                                                                                                        }
                                                                                                                                    }


                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                        System.out.println("xxx");
                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("yyy");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    if (bookeddaysthismonth1 != null) {
                                                                                                                                        System.out.println("xxx");
                                                                                                                                        if (bookeddaysthismonth1.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("yyy");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked1 = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println(counterthisholidays + "zzz");
                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                        bookthis = 1;
                                                                                                                                        System.out.println("aab");
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    System.out.println("aac");

                                                                                                                                    i++;
                                                                                                                                }
                                                                                                                                System.out.println(alreadybooked);
                                                                                                                                System.out.println(bookthis);
                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days)
                                                                                                                                {

                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;

                                                                                                                                    while (k <= monthLastDatenext) {
                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                            System.out.println("aa");
                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                System.out.println("bb");
                                                                                                                                                System.out.println(k + "c");
                                                                                                                                                counternextholidays++;

                                                                                                                                            }
                                                                                                                                        }


                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                            System.out.println("cc");
                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                System.out.println("dd");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (bookeddaysnextmonth1 != null) {
                                                                                                                                            System.out.println("cc");
                                                                                                                                            if (bookeddaysnextmonth1.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                System.out.println("dd");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                            booknext = 3;
                                                                                                                                            System.out.println("ee");
                                                                                                                                            System.out.println(k);

                                                                                                                                            break;
                                                                                                                                        }

                                                                                                                                        k++;


                                                                                                                                    }


                                                                                                                                }

                                                                                                                                if (bookthis == 1)
                                                                                                                                {
                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(alreadybooked + "aaca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aacab"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb9 aacaba"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb9 aacaba"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb10 aaab");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb10 aaab");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb11 aaaba");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb11 aaaba");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    System.out.println("aaabba");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aaabbaa"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb12 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb12 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb13 aabbc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb13 aabbc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb14 aaabbb");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb14 aaabbb");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println("f");
                                                                                                                                    System.out.println(counterthisholidays + "fa");
                                                                                                                                    System.out.println(i - counterthisholidays + "fb");

                                                                                                                                }
                                                                                                                                else if (booknext == 3)
                                                                                                                                {
                                                                                                                                    {
                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                        System.out.println("not null not null");

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(counterholidaysthis + "abca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "abca"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb15 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb15 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb16 abcc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb16 abcc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb17 abcdaa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb17 abcdaa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println(counternextholidays);
                                                                                                                                    System.out.println("ffa");
                                                                                                                                    System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                }

                                                                                                                                if (alreadybooked == 2 ||alreadybooked1 == 2||alreadybookednext == 4 || alreadybookednext1 == 4)
                                                                                                                                {
                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ggaa");
                                                                                                                                }

                                                                                                                            }

                                                                                                                        }
                                                                                                                    });
                                                                                                        }

                                                                                                    }
                                                                                                });

                                                                                    } else {
                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                if (document.exists()) {
                                                                                                    String phone = document.getString("phoneNo");
                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                    intent.putExtra("phone", phone);
                                                                                                    startActivity(intent);
                                                                                                    finish();
                                                                                                }
//
                                                                                            }
                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                startActivity(intent);
                                                                                                finish();
                                                                                            }
                                                                                        });
                                                                                        alert.show();

                                                                                    }
                                                                                }
                                                                            }

                                                                        }
                                                                    });

                                                                }
                                                            }
                                                            else{
                                                                {
                                                                    System.out.println("ttta");

                                                                    if (monthOfYear < 11) {
                                                                        monthOfYearNext = monthOfYear + 1;
                                                                        yearNext = year;
                                                                    } else if (monthOfYear == 11) {
                                                                        monthOfYearNext = 0;
                                                                        yearNext = year + 1;

                                                                    }
                                                                    if (monthOfYear < 10) {
                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                        yearNextnext = year;
                                                                    } else if (monthOfYear == 10) {
                                                                        monthOfYearNextnext = 0;
                                                                        yearNextnext = year + 1;

                                                                    }

                                                                    textmonth = MONTHS[monthOfYear];
                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                    //y = String.valueOf(year);
                                                                    yn = String.valueOf(yearNext);
                                                                    ynn = String.valueOf(yearNextnext);
                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                    t1 = c1.getTimeInMillis();
                                                                    String y = String.valueOf(year);
                                                                    Calendar c11 = Calendar.getInstance();
                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    System.out.println(monthLastDatenext);

                                                                    FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                            if (task.isSuccessful()) {
                                                                                DocumentSnapshot document = task.getResult();
                                                                                if (document.exists()) {
                                                                                    if (!document.get("name").equals("")) {
                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                    @Override
                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                        if (task.isSuccessful()) {
                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1).get()
                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                        @Override
                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                int i = dayOfMonth;
                                                                                                                                int counterthisholidays = 0;
                                                                                                                                int counternextholidays = 0;
                                                                                                                                int alreadybookednext = 0;
                                                                                                                                int booknext = 0;
                                                                                                                                int bookthis = 0;
                                                                                                                                int alreadybooked = 0;
                                                                                                                                int k = 1;
                                                                                                                                int daysbookedthis;
                                                                                                                                System.out.println(i + "uuu");
                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println(i + "vvv");
                                                                                                                                            counterthisholidays++;
                                                                                                                                            System.out.println(counterthisholidays + "www");
                                                                                                                                        }
                                                                                                                                    }



                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                        System.out.println("xxx");
                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("yyy");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    if (bookeddaysthismonth1 != null) {
                                                                                                                                        System.out.println("xxx");
                                                                                                                                        if (bookeddaysthismonth1.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("yyy");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked1 = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println(counterthisholidays + "zzz");
                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                        bookthis = 1;
                                                                                                                                        System.out.println("aab");
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    System.out.println("aac");

                                                                                                                                    i++;
                                                                                                                                }
                                                                                                                                System.out.println(alreadybooked);
                                                                                                                                System.out.println(bookthis);
                                                                                                                                if (bookthis == 1) {
                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(alreadybooked + "aaca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aacab"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb18 aacaba"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb18 aacaba"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb19 aaab");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb19 aaab");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb20 aaaba");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb20 aaaba");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    System.out.println("aaabba");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aaabbaa"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb21 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb21 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb22 aabbc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb22 aabbc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb23 aaabbb");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb23 aaabbb");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println("f");
                                                                                                                                    System.out.println(counterthisholidays + "fa");
                                                                                                                                    System.out.println(i - counterthisholidays + "fb");

                                                                                                                                }
                                                                                                                                if (alreadybooked == 2||alreadybooked1 == 2) {
                                                                                                                                    System.out.println("already booked..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ga");

                                                                                                                                }

                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;

                                                                                                                                    while (k <= monthLastDatenext) {

                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                            System.out.println("aa");
                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                System.out.println("bb");
                                                                                                                                                System.out.println(k + "c");
                                                                                                                                                counternextholidays++;

                                                                                                                                            }
                                                                                                                                        }


                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                            System.out.println("cc");
                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                System.out.println("dd");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (bookeddaysnextmonth1 != null) {
                                                                                                                                            System.out.println("cc");
                                                                                                                                            if (bookeddaysnextmonth1.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext1 = 4;
                                                                                                                                                System.out.println("dd");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                            booknext = 3;
                                                                                                                                            System.out.println("ee");
                                                                                                                                            System.out.println(k);

                                                                                                                                            break;
                                                                                                                                        }

                                                                                                                                        k++;


                                                                                                                                    }


                                                                                                                                }

                                                                                                                                if (booknext == 3) {
                                                                                                                                    {
                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                        System.out.println("not null not null");

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(counterholidaysthis + "abca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "abca"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb24 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb24 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb25 abcc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb25 abcc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb26 abcdaa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb26 abcdaa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println(counternextholidays);
                                                                                                                                    System.out.println("ffa");
                                                                                                                                    System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                }
                                                                                                                                if (alreadybookednext == 4||alreadybookednext1 == 4) {
                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ggaa");
                                                                                                                                }

                                                                                                                            }

                                                                                                                        }
                                                                                                                    });
                                                                                                        }

                                                                                                    }
                                                                                                });

                                                                                    } else {
                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                if (document.exists()) {
                                                                                                    String phone = document.getString("phoneNo");
                                                                                                    //Toast.makeText(CustomCalendar.this, phone, Toast.LENGTH_SHORT).show();
                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                    intent.putExtra("phone", phone);
                                                                                                    startActivity(intent);
                                                                                                    finish();
                                                                                                }
                                                                                            }
                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                startActivity(intent);
                                                                                                finish();
                                                                                            }
                                                                                        });
                                                                                        alert.show();

                                                                                    }
                                                                                }
                                                                            }

                                                                        }
                                                                    });

                                                                }
                                                            }

                                                        }

                                                    }

                                                }
                                            });

                                        }

                                    }

                                }
                            });
                        }
                                }
                            }
                        });
                    }
                },
                // on below line we are passing year,
                // month and day for selected date in our date picker.
                year, month, day);
        //Calendar calender = Calendar.getInstance();
        long today = c1.getTimeInMillis();
        final long oneDay = 24 * 60 * 60 * 1000L;

        datePickerDialog.getDatePicker().setMinDate(today+oneDay);

        datePickerDialog.getDatePicker().setMaxDate(today + 90 * oneDay);
        //Date nextMonth = new Date(today + 30 * oneDay);
        //Date previousDays = new Date(today - 1000);
        /*Calendar today = Calendar.getInstance();
        Calendar twoDaysAgo = (Calendar) today.clone();
        twoDaysAgo.add(Calendar.DATE, -2);
        Calendar twoDaysLater = (Calendar) today.clone();
        twoDaysLater.add(Calendar.DATE, 2);*/
        //datePickerDialog.getDatePicker().setMinDate(System.currentTimeMillis() - 1000);
        // at last we are calling show to
        // display our date picker dialog.
        //Toast.makeText(this, "show2", Toast.LENGTH_SHORT).show();
        datePickerDialog.show();

    }
    public void addMealFixedPlan(int days, String meal)
    {
        {
            final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

            final Calendar c1 = Calendar.getInstance();

            // on below line we are getting
            // our day, month and year.
            int year = c1.get(Calendar.YEAR);
            int month = c1.get(Calendar.MONTH);
            int day = c1.get(Calendar.DAY_OF_MONTH);




            // on below line we are creating a variable for date picker dialog.
            DatePickerDialog datePickerDialog = new DatePickerDialog(
                    // on below line we are passing context.
                    DatePicker1.this,
                    new DatePickerDialog.OnDateSetListener() {
                        @Override
                        public void onDateSet(DatePicker view, int year,
                                              int monthOfYear, int dayOfMonth)
                        {
                            if (monthOfYear < 11) {
                                monthOfYearNext = monthOfYear + 1;
                                yearNext = year;
                            } else if (monthOfYear == 11) {
                                monthOfYearNext = 0;
                                yearNext = year + 1;

                            }
                            if (monthOfYear < 10) {
                                monthOfYearNextnext = monthOfYear + 2;
                                yearNextnext = year;
                            } else if (monthOfYear == 10) {
                                monthOfYearNextnext = 0;
                                yearNextnext = year + 1;

                            }

                            textmonth = MONTHS[monthOfYear];
                            textMonthnext = MONTHS[monthOfYearNext];
                            textMonthnextnext = MONTHS[monthOfYearNextnext];
                            y = String.valueOf(year);
                            yn = String.valueOf(yearNext);
                            ynn = String.valueOf(yearNextnext);
                            tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                            t1 = c1.getTimeInMillis();
                            String y = String.valueOf(year);
                            Calendar c11 = Calendar.getInstance();
                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                            System.out.println(monthLastDatenext);
                            FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                            docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                @Override
                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                    if (task.isSuccessful()) {
                                        DocumentSnapshot document = task.getResult();
                                        if (document.exists()) {
                                            if (!document.get("name").equals("")) {
                                                fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                        get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                            @Override
                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                if (task.isSuccessful()) {
                                                                    ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                    ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                    ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                    fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                            .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                @Override
                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                    DocumentSnapshot documentSnapshot = task.getResult();
                                                                                    if (documentSnapshot.exists()) {
                                                                                        ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                        ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                        ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                        System.out.println(textmonth + " " + y);
                                                                                        int i = dayOfMonth;
                                                                                        int counterthisholidays = 0;
                                                                                        int counternextholidays = 0;
                                                                                        int alreadybookednext = 0;
                                                                                        int booknext = 0;
                                                                                        int bookthis = 0;
                                                                                        int alreadybooked = 0;
                                                                                        int k = 1;
                                                                                        int daysbookedthis;
                                                                                        System.out.println(i + "aa");
                                                                                        System.out.println(monthLastDate + "aaabbb");


                                                                                        while (i <= monthLastDate) {
                                                                                            if (holidays != null) {

                                                                                                if (holidays.contains(String.valueOf(i))) {
                                                                                                    counterthisholidays++;
                                                                                                    System.out.println(i);
//
                                                                                                }


                                                                                            }

                                                                                            if (bookeddaysthismonth != null) {
                                                                                                System.out.println("dd");
                                                                                                if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                    System.out.println("ee");
                                                                                                    System.out.println(i);
                                                                                                    alreadybooked = 2;
                                                                                                    break;
                                                                                                }
                                                                                            }
                                                                                            System.out.println(counterthisholidays + "ff");
                                                                                            if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                bookthis = 1;
                                                                                                System.out.println("gg");
                                                                                                break;
                                                                                            }
                                                                                            System.out.println("hh");

                                                                                            i++;
                                                                                        }
                                                                                        System.out.println(alreadybooked + "ii");
                                                                                        System.out.println(bookthis + "jj");
                                                                                        if (bookthis == 1) {
                                                                                            int counterholidaysnext = 0;
                                                                                            int counterholidaysthis = 0;
                                                                                            int counterholidaysnextnext = 0;
                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                            {

                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                    if (l == monthLastDate + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidays != null) {
                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                            counterholidaysthis++;
                                                                                                            System.out.println((counterholidaysthis + "kkb"));
                                                                                                            continue;
                                                                                                        }
                                                                                                    }
                                                                                                    System.out.println((l + "kk"));

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println(("fb1 kka"));
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                }
                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                System.out.println(daysthismonth + "ll");
                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                int counternextbook = 0;
                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidaysnext != null) {
                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                            counterholidaysnext++;
                                                                                                            System.out.println(counterholidaysnext + "mm");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }
                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println("fb2 kkc");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                    counternextbook++;
                                                                                                }

                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                System.out.println(daysnextnext + "nn");
                                                                                                int counternextnextbook = 0;
                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidaysnextnext != null) {
                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                            counterholidaysnextnext++;
                                                                                                            System.out.println(counterholidaysnext + "oo");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println("fb3 ooa");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                    counternextnextbook++;

                                                                                                }

                                                                                            }
                                                                                            {

                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                    if (l == monthLastDate + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidays != null) {
                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                            //counterholidaysthis++;
                                                                                                            continue;
                                                                                                        }
                                                                                                    }
                                                                                                    System.out.println((counterholidaysthis + "ppa"));
                                                                                                    System.out.println((l + "pp"));

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println(("ppa1"));
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                }
                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                System.out.println(daysthismonth + "qq");
                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                int counternextbook = 0;
                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidaysnext != null) {
                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                            counterholidaysnext++;
                                                                                                            System.out.println(counterholidaysnext + "rr");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println("fb4 ss");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                    counternextbook++;
                                                                                                }

                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                System.out.println(daysnextnext);
                                                                                                int counternextnextbook = 0;
                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidaysnextnext != null) {
                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                            counterholidaysnextnext++;
                                                                                                            System.out.println(counterholidaysnext + "tt");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println(" fb5 uu");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                    counternextnextbook++;

                                                                                                }

                                                                                            }

                                                                                            System.out.println("..bookmeal");
                                                                                            alertDialogSuccessfulBooking();
                                                                                            System.out.println("vv");
                                                                                            System.out.println(counterthisholidays + "vva");
                                                                                            System.out.println(i - counterthisholidays + "vvaa");

                                                                                        }

                                                                                        if (alreadybooked == 2) {
                                                                                            System.out.println("already booked..");
                                                                                            alertDialogAlreadyBooked();
                                                                                            System.out.println("ww");

                                                                                        }

                                                                                        if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                            daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                            while (k <= monthLastDatenext) {

//
                                                                                                if (holidaysnext != null) {
                                                                                                    System.out.println("aaa");
                                                                                                    if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                        System.out.println("bbb");
                                                                                                        System.out.println(k + "ccc");
                                                                                                        counternextholidays++;

                                                                                                    }
                                                                                                }


                                                                                                System.out.println(counternextholidays);

                                                                                                if (bookeddaysnextmonth != null) {
                                                                                                    System.out.println("ddd");
                                                                                                    if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                        alreadybookednext = 4;
                                                                                                        System.out.println("eee");
                                                                                                        System.out.println(k);

                                                                                                        break;

                                                                                                    }

                                                                                                }
                                                                                                if (k - counternextholidays == days - daysbookedthis) {
                                                                                                    booknext = 3;
                                                                                                    System.out.println("fff");
                                                                                                    System.out.println(k);

                                                                                                    break;
                                                                                                }

                                                                                                k++;


                                                                                            }


                                                                                        }

                                                                                        if (booknext == 3) {
                                                                                            {
                                                                                                int counterholidaysnext = 0;
                                                                                                int counterholidaysthis = 0;
                                                                                                int counterholidaysnextnext = 0;

                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                    if (l == monthLastDate + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidays != null) {
                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                            counterholidaysthis++;
                                                                                                            System.out.println("wwa");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }
                                                                                                    System.out.println((l + "ggg"));

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println("fb6 ss");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                }
                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                System.out.println(daysthismonth + "hhh");
                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                int counternextbook = 0;
                                                                                                for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                    if (p == monthLastDatenext + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidaysnext != null) {
                                                                                                        if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                            counterholidaysnext++;
                                                                                                            System.out.println(counterholidaysnext + "iii");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }
                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println("fb7 jjj");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                    counternextbook++;
                                                                                                }

                                                                                                int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                System.out.println(daysnextnext + "kkk");
                                                                                                int counternextnextbook = 0;
                                                                                                for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                    if (p == monthLastDatenextnext + 1) {
                                                                                                        break;
                                                                                                    }
                                                                                                    if (holidaysnextnext != null) {
                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                            counterholidaysnextnext++;
                                                                                                            System.out.println(counterholidaysnext + "lll");
                                                                                                            continue;
                                                                                                        }
                                                                                                    }

                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                @Override
                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                    System.out.println("fb8 mmm");
                                                                                                                }
                                                                                                            })
                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                @Override
                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                }
                                                                                                            });
                                                                                                    counternextnextbook++;

                                                                                                }

                                                                                            }

                                                                                            System.out.println("..bookmealnext");
                                                                                            alertDialogSuccessfulBooking();
                                                                                            System.out.println(counternextholidays + "nnn");
                                                                                            System.out.println("ooo");
                                                                                            System.out.println(k - counternextholidays + "ppp");
                                                                                        }
                                                                                        if (alreadybookednext == 4) {
                                                                                            System.out.println("already booked next..");
                                                                                            alertDialogAlreadyBooked();
                                                                                            System.out.println("qqq");
                                                                                        }

                                                                                    }

                                                                                }
                                                                            });
                                                                }

                                                            }
                                                        });

                                            } else {
                                                AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                alert.setTitle(" Please update Profile with address");
                                                alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                    @Override
                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                        if (document.exists()) {
                                                            String phone = document.getString("phoneNo");
                                                            Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                            intent.putExtra("phone", phone);
                                                            startActivity(intent);
                                                            finish();
                                                        }
                                                    }
                                                }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                    @Override
                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                        Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                        startActivity(intent);
                                                        finish();
                                                    }
                                                });
                                                alert.show();

                                            }
                                        }
                                    }

                                }
                            });
                        }
                    },
                    year, month, day);
//            long today = c1.getTimeInMillis();
//            final long oneDay = 24 * 60 * 60 * 1000L;
//
//            datePickerDialog.getDatePicker().setMinDate(today+oneDay);
//            String da=String.valueOf(datePickerDialog.getDatePicker().getDayOfMonth());
//
//            datePickerDialog.getDatePicker().setMaxDate(today + 90 * oneDay);
            //Date nextMonth = new Date(today + 30 * oneDay);
            //Date previousDays = new Date(today - 1000);
        /*Calendar today = Calendar.getInstance();
        Calendar twoDaysAgo = (Calendar) today.clone();
        twoDaysAgo.add(Calendar.DATE, -2);
        Calendar twoDaysLater = (Calendar) today.clone();
        twoDaysLater.add(Calendar.DATE, 2);*/
            //datePickerDialog.getDatePicker().setMinDate(System.currentTimeMillis() - 1000);
            // at last we are calling show to
            // display our date picker dialog.
            //Toast.makeText(this, "show2", Toast.LENGTH_SHORT).show();
            //datePickerDialog.show();


        }
    }
    public void addMealCustomPlan(int days, String meal)
    {
        final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

        final Calendar c1 = Calendar.getInstance();

        // on below line we are getting
        // our day, month and year.
        int year = c1.get(Calendar.YEAR);
        int month = c1.get(Calendar.MONTH);
        int day = c1.get(Calendar.DAY_OF_MONTH);




        // on below line we are creating a variable for date picker dialog.
        DatePickerDialog datePickerDialog = new DatePickerDialog(
                // on below line we are passing context.
                DatePicker1.this,
                new DatePickerDialog.OnDateSetListener() {
                    @Override
                    public void onDateSet(DatePicker view, int year,
                                          int monthOfYear, int dayOfMonth){
                        {
                            DocumentReference documentReference = fstore.collection("users").document(userID).collection("events").document("dinner");
                            documentReference.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                @Override
                                public void onComplete(Task<DocumentSnapshot> task) {
                                    if (task.isSuccessful()) {
                                        DocumentSnapshot documentSnapshot = task.getResult();
                                        if (documentSnapshot != null) {
                                            Map<String, Object> map = documentSnapshot.getData();
                                            fieldSizeDinner = map.size();
                                            System.out.println("....++" + fieldSizeDinner);
                                            DocumentReference documentReference1 = fstore.collection("users").document(userID).collection("events").document("lunch");
                                            documentReference1.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                @Override
                                                public void onComplete(Task<DocumentSnapshot> task) {
                                                    if (task.isSuccessful()) {
                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                        if (documentSnapshot != null) {
                                                            Map<String, Object> map = documentSnapshot.getData();
                                                            fieldSizeLunch = map.size();
                                                            System.out.println("....++" + fieldSizeDinner);
                                                            System.out.println("sss.." + fieldSizeLunch + "ttt.." + fieldSizeDinner);
                                                            if (fieldSizeDinner < 2 && fieldSizeLunch < 2) {


                                                                if (a < 7) {
                                                                    AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                    alert.setTitle(" First time Booking");
                                                                    alert.setMessage("First time booking, minimum 7 days required !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                                                                        @Override
                                                                        public void onClick(DialogInterface dialogInterface, int i) {
                                                                            cbcustom.setChecked(false);
                                                                            //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                        }
                                                                    }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                                                                        @Override
                                                                        public void onClick(DialogInterface dialogInterface, int i) {

                                                                        }
                                                                    });
                                                                    alert.show();
                                                                } else {
                                                                    System.out.println("ttta");

                                                                    if (monthOfYear < 11) {
                                                                        monthOfYearNext = monthOfYear + 1;
                                                                        yearNext = year;
                                                                    } else if (monthOfYear == 11) {
                                                                        monthOfYearNext = 0;
                                                                        yearNext = year + 1;

                                                                    }
                                                                    if (monthOfYear < 10) {
                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                        yearNextnext = year;
                                                                    } else if (monthOfYear == 10) {
                                                                        monthOfYearNextnext = 0;
                                                                        yearNextnext = year + 1;

                                                                    }

                                                                    textmonth = MONTHS[monthOfYear];
                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                    y = String.valueOf(year);
                                                                    yn = String.valueOf(yearNext);
                                                                    ynn = String.valueOf(yearNextnext);
                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                    t1 = c1.getTimeInMillis();
                                                                    String y = String.valueOf(year);
                                                                    Calendar c11 = Calendar.getInstance();
                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    System.out.println(monthLastDatenext);

                                                                    FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                            if (task.isSuccessful()) {
                                                                                DocumentSnapshot document = task.getResult();
                                                                                if (document.exists()) {
                                                                                    if (!document.get("name").equals("")) {
                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                    @Override
                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                        if (task.isSuccessful()) {
                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                        @Override
                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                int i = dayOfMonth;
                                                                                                                                int counterthisholidays = 0;
                                                                                                                                int counternextholidays = 0;
                                                                                                                                int alreadybookednext = 0;
                                                                                                                                int booknext = 0;
                                                                                                                                int bookthis = 0;
                                                                                                                                int alreadybooked = 0;
                                                                                                                                int k = 1;
                                                                                                                                int daysbookedthis;
                                                                                                                                System.out.println(i + "uuu");
                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println(i + "vvv");
                                                                                                                                            counterthisholidays++;
                                                                                                                                            System.out.println(counterthisholidays + "www");
                                                                                                                                        }
                                                                                                                                    }

                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                        System.out.println("xxx");
                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("yyy");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println(counterthisholidays + "zzz");
                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                        bookthis = 1;
                                                                                                                                        System.out.println("aab");
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    System.out.println("aac");

                                                                                                                                    i++;
                                                                                                                                }
                                                                                                                                System.out.println(alreadybooked);
                                                                                                                                System.out.println(bookthis);
                                                                                                                                if (bookthis == 1) {
                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(alreadybooked + "aaca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aacab"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb9 aacaba"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb10 aaab");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb11 aaaba");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {

                                                                                                                                                    System.out.println("aaabba");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aaabbaa"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb12 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb13 aabbc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb14 aaabbb");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println("f");
                                                                                                                                    System.out.println(counterthisholidays + "fa");
                                                                                                                                    System.out.println(i - counterthisholidays + "fb");

                                                                                                                                }
                                                                                                                                if (alreadybooked == 2) {
                                                                                                                                    System.out.println("already booked..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ga");

                                                                                                                                }

                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                    while (k <= monthLastDatenext) {

//
                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                            System.out.println("aa");
                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                System.out.println("bb");
                                                                                                                                                System.out.println(k + "c");
                                                                                                                                                counternextholidays++;

                                                                                                                                            }
                                                                                                                                        }


                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                            System.out.println("cc");
                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                System.out.println("dd");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                            booknext = 3;
                                                                                                                                            System.out.println("ee");
                                                                                                                                            System.out.println(k);

                                                                                                                                            break;
                                                                                                                                        }

                                                                                                                                        k++;


                                                                                                                                    }


                                                                                                                                }

                                                                                                                                if (booknext == 3) {
                                                                                                                                    {
                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                        System.out.println("not null not null");

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(counterholidaysthis + "abca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "abca"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb15 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb16 abcc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb17 abcdaa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println(counternextholidays);
                                                                                                                                    System.out.println("ffa");
                                                                                                                                    System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                }
                                                                                                                                if (alreadybookednext == 4) {
                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ggaa");
                                                                                                                                }

                                                                                                                            }

                                                                                                                        }
                                                                                                                    });
                                                                                                        }

                                                                                                    }
                                                                                                });

                                                                                    } else {
                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                if (document.exists()) {
                                                                                                    String phone = document.getString("phoneNo");
                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                    intent.putExtra("phone", phone);
                                                                                                    startActivity(intent);
                                                                                                    finish();
                                                                                                }
                                                                                            }
                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                startActivity(intent);
                                                                                                finish();
                                                                                            }
                                                                                        });
                                                                                        alert.show();

                                                                                    }
                                                                                }
                                                                            }

                                                                        }
                                                                    });

                                                                }
                                                            } else {
                                                                {
                                                                    System.out.println("ttta");

                                                                    if (monthOfYear < 11) {
                                                                        monthOfYearNext = monthOfYear + 1;
                                                                        yearNext = year;
                                                                    } else if (monthOfYear == 11) {
                                                                        monthOfYearNext = 0;
                                                                        yearNext = year + 1;

                                                                    }
                                                                    if (monthOfYear < 10) {
                                                                        monthOfYearNextnext = monthOfYear + 2;
                                                                        yearNextnext = year;
                                                                    } else if (monthOfYear == 10) {
                                                                        monthOfYearNextnext = 0;
                                                                        yearNextnext = year + 1;

                                                                    }

                                                                    textmonth = MONTHS[monthOfYear];
                                                                    textMonthnext = MONTHS[monthOfYearNext];
                                                                    textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                    y = String.valueOf(year);
                                                                    yn = String.valueOf(yearNext);
                                                                    ynn = String.valueOf(yearNextnext);
                                                                    tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                    t1 = c1.getTimeInMillis();
                                                                    String y = String.valueOf(year);
                                                                    Calendar c11 = Calendar.getInstance();
                                                                    Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                    int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                    int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                    int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                    System.out.println(monthLastDatenext);

                                                                    FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                    DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                    docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                        @Override
                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                            if (task.isSuccessful()) {
                                                                                DocumentSnapshot document = task.getResult();
                                                                                if (document.exists()) {
                                                                                    if (!document.get("name").equals("")) {
                                                                                        fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                    @Override
                                                                                                    public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                        DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                        if (task.isSuccessful()) {
                                                                                                            ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                            ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                            ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal).get()
                                                                                                                    .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                        @Override
                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                            if (documentSnapshot.exists()) {
                                                                                                                                ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                System.out.println(textmonth + " " + y);
                                                                                                                                int i = dayOfMonth;
                                                                                                                                int counterthisholidays = 0;
                                                                                                                                int counternextholidays = 0;
                                                                                                                                int alreadybookednext = 0;
                                                                                                                                int booknext = 0;
                                                                                                                                int bookthis = 0;
                                                                                                                                int alreadybooked = 0;
                                                                                                                                int k = 1;
                                                                                                                                int daysbookedthis;
                                                                                                                                System.out.println(i + "uuu");
                                                                                                                                while (i <= monthLastDate) {
                                                                                                                                    if (holidays != null) {
                                                                                                                                        if (holidays.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println(i + "vvv");
                                                                                                                                            counterthisholidays++;
                                                                                                                                            System.out.println(counterthisholidays + "www");
                                                                                                                                        }
                                                                                                                                    }


                                                                                                                                    if (bookeddaysthismonth != null) {
                                                                                                                                        System.out.println("xxx");
                                                                                                                                        if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                            System.out.println("yyy");
                                                                                                                                            System.out.println(i);
                                                                                                                                            alreadybooked = 2;
                                                                                                                                            break;
                                                                                                                                        }
                                                                                                                                    }
                                                                                                                                    System.out.println(counterthisholidays + "zzz");
                                                                                                                                    if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                        bookthis = 1;
                                                                                                                                        System.out.println("aab");
                                                                                                                                        break;
                                                                                                                                    }
                                                                                                                                    System.out.println("aac");

                                                                                                                                    i++;
                                                                                                                                }
                                                                                                                                System.out.println(alreadybooked);
                                                                                                                                System.out.println(bookthis);
                                                                                                                                if (bookthis == 1) {
                                                                                                                                    int counterholidaysnext = 0;
                                                                                                                                    int counterholidaysthis = 0;
                                                                                                                                    int counterholidaysnextnext = 0;
                                                                                                                                    System.out.println(textMonthnext + " " + yn);
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(alreadybooked + "aaca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aacab"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println(("fb18 aacaba"));
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb19 aaab");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb20 aaaba");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }
                                                                                                                                    {

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    System.out.println("aaabba");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "aaabbaa"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb21 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb22 aabbc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb23 aaabbb");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmeal");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println("f");
                                                                                                                                    System.out.println(counterthisholidays + "fa");
                                                                                                                                    System.out.println(i - counterthisholidays + "fb");

                                                                                                                                }
                                                                                                                                if (alreadybooked == 2) {
                                                                                                                                    System.out.println("already booked..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ga");

                                                                                                                                }

                                                                                                                                if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                    daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;


                                                                                                                                    while (k <= monthLastDatenext) {

                                                                                                                                        if (holidaysnext != null) {
                                                                                                                                            System.out.println("aa");
                                                                                                                                            if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                System.out.println("bb");
                                                                                                                                                System.out.println(k + "c");
                                                                                                                                                counternextholidays++;

                                                                                                                                            }
                                                                                                                                        }


                                                                                                                                        System.out.println(counternextholidays);

                                                                                                                                        if (bookeddaysnextmonth != null) {
                                                                                                                                            System.out.println("cc");
                                                                                                                                            if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                alreadybookednext = 4;
                                                                                                                                                System.out.println("dd");
                                                                                                                                                System.out.println(k);

                                                                                                                                                break;

                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                        if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                            booknext = 3;
                                                                                                                                            System.out.println("ee");
                                                                                                                                            System.out.println(k);

                                                                                                                                            break;
                                                                                                                                        }

                                                                                                                                        k++;


                                                                                                                                    }


                                                                                                                                }

                                                                                                                                if (booknext == 3) {
                                                                                                                                    {
                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                        int counterholidaysnextnext = 0;

                                                                                                                                        System.out.println("not null not null");

                                                                                                                                        for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                            if (l == monthLastDate + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidays != null) {
                                                                                                                                                if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                    counterholidaysthis++;
                                                                                                                                                    System.out.println(counterholidaysthis + "abca");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            System.out.println((l + "abca"));

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb24 ss");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                        }
                                                                                                                                        daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                        System.out.println(daysthismonth);
                                                                                                                                        daysnextmonth = days - daysthismonth;
                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                        int counternextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                            if (p == monthLastDatenext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }
                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb25 abcc");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextbook++;
                                                                                                                                        }

                                                                                                                                        int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                        System.out.println(daysnextnext);
                                                                                                                                        int counternextnextbook = 0;
                                                                                                                                        for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                            if (p == monthLastDatenextnext + 1) {
                                                                                                                                                break;
                                                                                                                                            }
                                                                                                                                            if (holidaysnextnext != null) {
                                                                                                                                                if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                    counterholidaysnextnext++;
                                                                                                                                                    System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                    continue;
                                                                                                                                                }
                                                                                                                                            }

                                                                                                                                            fstore.collection("users").document(userID).collection("events").document(meal)
                                                                                                                                                    .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                    .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onSuccess(Void aVoid) {
                                                                                                                                                            System.out.println("fb26 abcdaa");
                                                                                                                                                        }
                                                                                                                                                    })
                                                                                                                                                    .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                        @Override
                                                                                                                                                        public void onFailure(@NonNull Exception e) {
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                            counternextnextbook++;

                                                                                                                                        }

                                                                                                                                    }

                                                                                                                                    System.out.println("..bookmealnext");
                                                                                                                                    alertDialogSuccessfulBooking();
                                                                                                                                    System.out.println(counternextholidays);
                                                                                                                                    System.out.println("ffa");
                                                                                                                                    System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                }
                                                                                                                                if (alreadybookednext == 4) {
                                                                                                                                    System.out.println("already booked next..");
                                                                                                                                    alertDialogAlreadyBooked();
                                                                                                                                    System.out.println("ggaa");
                                                                                                                                }

                                                                                                                            }

                                                                                                                        }
                                                                                                                    });
                                                                                                        }

                                                                                                    }
                                                                                                });

                                                                                    } else {
                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                        alert.setTitle(" Please update Profile with address");
                                                                                        alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                if (document.exists()) {
                                                                                                    String phone = document.getString("phoneNo");
                                                                                                    Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                    intent.putExtra("phone", phone);
                                                                                                    startActivity(intent);
                                                                                                    finish();
                                                                                                }
                                                                                                ;
                                                                                            }
                                                                                        }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                startActivity(intent);
                                                                                                finish();
                                                                                            }
                                                                                        });
                                                                                        alert.show();

                                                                                    }
                                                                                }
                                                                            }

                                                                        }
                                                                    });

                                                                }
                                                            }

                                                        }

                                                    }

                                                }
                                            });

                                        }

                                    }

                                }
                            });
                        }
                    }

                },
                year, month, day);


    }
    public void addMealLunchDinnerFixedPlan(int days, String meal1,String meal2)
    {
        final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

        final Calendar c1 = Calendar.getInstance();

        // on below line we are getting
        // our day, month and year.
        int year = c1.get(Calendar.YEAR);
        int month = c1.get(Calendar.MONTH);
        int day = c1.get(Calendar.DAY_OF_MONTH);




        // on below line we are creating a variable for date picker dialog.
        DatePickerDialog datePickerDialog = new DatePickerDialog(
                // on below line we are passing context.
                DatePicker1.this,
                new DatePickerDialog.OnDateSetListener() {
                    @Override
                    public void onDateSet(DatePicker view, int year,
                                          int monthOfYear, int dayOfMonth){
                        {

                            if(monthOfYear<11){
                                monthOfYearNext=monthOfYear+1;
                                yearNext=year;
                            } else if (monthOfYear==11) {
                                monthOfYearNext=0;
                                yearNext=year+1;

                            }
                            if(monthOfYear<10){
                                monthOfYearNextnext=monthOfYear+2;
                                yearNextnext=year;
                            } else if (monthOfYear==10) {
                                monthOfYearNextnext=0;
                                yearNextnext=year+1;

                            }

                            textmonth=MONTHS[monthOfYear];
                            textMonthnext=MONTHS[monthOfYearNext];
                            textMonthnextnext=MONTHS[monthOfYearNextnext];
                            y=String.valueOf(year);
                            yn=String.valueOf(yearNext);
                            ynn=String.valueOf(yearNextnext);
                            tvinitialdate.setText("Initial Booking Date: "+dayOfMonth+"/"+(monthOfYear+1)+"/"+year);
                            t1 = c1.getTimeInMillis();
                            String y = String.valueOf(year);
                            Calendar c11=Calendar.getInstance();
                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                            System.out.println(monthLastDatenext);
                            FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                            docIdRef.collection("events").document(meal2).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                @Override
                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                    DocumentSnapshot documentSnapshot=task.getResult();
                                    if(documentSnapshot.exists()){
                                        ArrayList<String> bookeddaysthismonth1 = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                        ArrayList<String> bookeddaysnextmonth1 = (ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                        ArrayList<String> bookeddaysnextnextmonth1 = (ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                                        {
                                            FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                                            docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                @Override
                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                    if (task.isSuccessful()){
                                                        DocumentSnapshot document = task.getResult();
                                                        if (document.exists()){
                                                            if (!document.get("name").equals(""))
                                                            {
                                                                fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                        get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                            @Override
                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                DocumentSnapshot documentSnapshot=task.getResult();
                                                                                if(task.isSuccessful()){
                                                                                    ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                                                                    ArrayList<String>holidaysnext=(ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                                                                    ArrayList<String>holidaysnextnext=(ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1).get()
                                                                                            .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                @Override
                                                                                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                    DocumentSnapshot documentSnapshot=task.getResult();
                                                                                                    if(documentSnapshot.exists()){
                                                                                                        ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                                                                                        ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                                                                                        ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                                                                                                        System.out.println(textmonth+" "+y);
                                                                                                        int i = dayOfMonth;
                                                                                                        int counterthisholidays = 0;
                                                                                                        int counternextholidays=0;
                                                                                                        int alreadybookednext=0;
                                                                                                        int booknext=0;
                                                                                                        int bookthis=0;
                                                                                                        int alreadybooked=0;
                                                                                                        int k=1;
                                                                                                        int daysbookedthis;
                                                                                                        System.out.println(i+"aa");
                                                                                                        System.out.println(monthLastDate+"aaabbb");


                                                                                                        while (i <= monthLastDate) {
                                                                                                            if(holidays!=null){

                                                                                                                if(holidays.contains(String.valueOf(i))){
                                                                                                                    counterthisholidays++;
                                                                                                                    System.out.println(i);
//                                                                                                    System.out.println(i+"bb");

//                                                                                                    System.out.println(counterthisholidays+"cc");
//                                                                                                    continue;
                                                                                                                }


                                                                                                            }

                                                                                                            if(bookeddaysthismonth!=null){
                                                                                                                System.out.println("dd");
                                                                                                                if(bookeddaysthismonth.contains(String.valueOf(i))){
                                                                                                                    System.out.println("ee");
                                                                                                                    System.out.println(i);
                                                                                                                    alreadybooked=2;
                                                                                                                    break;
                                                                                                                }
                                                                                                            }
                                                                                                            if(bookeddaysthismonth1!=null){
                                                                                                                System.out.println("dd1");
                                                                                                                if(bookeddaysthismonth1.contains(String.valueOf(i))){
                                                                                                                    System.out.println("ee1");
                                                                                                                    System.out.println(i);
                                                                                                                    alreadybooked1=2;
                                                                                                                    break;
                                                                                                                }
                                                                                                            }
                                                                                                            System.out.println(counterthisholidays+"ff1");
                                                                                                            if(i-dayOfMonth-counterthisholidays==days-1){
                                                                                                                bookthis=1;
                                                                                                                System.out.println("gg1");
                                                                                                                break;
                                                                                                            }
                                                                                                            System.out.println("hh1");

                                                                                                            i++;
                                                                                                        }
                                                                                                        System.out.println(alreadybooked+"ii");
                                                                                                        System.out.println(bookthis+"jj");
                                                                                                        if(monthLastDate-dayOfMonth-counterthisholidays+1<days)
                                                                                                        {

                                                                                                            daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;
                                                                                                            //System.out.println(daysbookedthis);
                                                                                                            //System.out.println(counterthisholidays);

                                                                                                            while (k <= monthLastDatenext) {

//                                                                                            while (k<days-daysbookedthis+counternextholidays+1) {
                                                                                                                //while (k<monthLastDatenext) {
                                                                                                                if (holidaysnext != null) {
                                                                                                                    System.out.println("aaa");
                                                                                                                    if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                        System.out.println("bbb");
                                                                                                                        System.out.println(k + "ccc");
                                                                                                                        counternextholidays++;

                                                                                                                    }
                                                                                                                }
                                                                                                                //System.out.println(holidaysnext.size() + "b");


                                                                                                                System.out.println(counternextholidays);

                                                                                                                if (bookeddaysnextmonth != null) {
                                                                                                                    System.out.println("ddd");
                                                                                                                    if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                        alreadybookednext = 4;
                                                                                                                        System.out.println("eee");
                                                                                                                        System.out.println(k);

                                                                                                                        break;

                                                                                                                    }

                                                                                                                }
                                                                                                                if (bookeddaysnextmonth1 != null) {
                                                                                                                    System.out.println("ddd");
                                                                                                                    if (bookeddaysnextmonth1.contains(String.valueOf(k))) {
                                                                                                                        alreadybookednext1 = 4;
                                                                                                                        System.out.println("eee");
                                                                                                                        System.out.println(k);

                                                                                                                        break;

                                                                                                                    }

                                                                                                                }
                                                                                                                if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                    booknext = 3;
                                                                                                                    System.out.println("fff");
                                                                                                                    System.out.println(k);

                                                                                                                    break;
                                                                                                                }

                                                                                                                k++;


                                                                                                            }


                                                                                                        }
                                                                                                        if(alreadybooked==2|| alreadybooked1==2||alreadybookednext == 4 ||alreadybookednext1 == 4)
                                                                                                        {
                                                                                                            System.out.println("already booked..all this");
                                                                                                            alertDialogAlreadyBooked();
                                                                                                            System.out.println("ww");
                                                                                                        }
                                                                                                        else if(bookthis==1)
                                                                                                        {
                                                                                                            int counterholidaysnext=0;
                                                                                                            int counterholidaysthis = 0;
                                                                                                            int counterholidaysnextnext=0;
                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                            {

                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidays !=null){
                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                            counterholidaysthis++;
                                                                                                                            System.out.println((counterholidaysthis+"kkb"));
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }
                                                                                                                    System.out.println((l+"kk"));

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println(("fb1 kka"));
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println(("fb1 kka"));
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                }
                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                System.out.println(daysthismonth+"ll");
                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                int counternextbook=0;
                                                                                                                for (int p = 1; p < daysnextmonth + 1+counterholidaysnext; p++) {
                                                                                                                    if(p==monthLastDatenext +1){
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidaysnext !=null){
                                                                                                                        if(holidaysnext.contains(String.valueOf(p))) {
                                                                                                                            counterholidaysnext++;
                                                                                                                            System.out.println(counterholidaysnext+"mm");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb2 kkc");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb2 kkc");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    counternextbook++;
                                                                                                                }

                                                                                                                int daysnextnext=days-daysthismonth-counternextbook;
                                                                                                                System.out.println(daysnextnext+"nn");
                                                                                                                int counternextnextbook=0;
                                                                                                                for (int p = 1; p < daysnextnext + 1+counterholidaysnextnext; p++) {
                                                                                                                    if(p==monthLastDatenextnext +1){
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidaysnextnext!=null) {
                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                            counterholidaysnextnext++;
                                                                                                                            System.out.println(counterholidaysnext + "oo");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb3 ooa");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb3 ooa");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    counternextnextbook++;

                                                                                                                }

                                                                                                            }
                                                                                                            {

                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidays !=null){
                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                            //counterholidaysthis++;
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }
                                                                                                                    System.out.println((counterholidaysthis+"ppa"));
                                                                                                                    System.out.println((l+"pp"));

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println(("ppa1"));
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println(("ppa1"));
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                }
                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                System.out.println(daysthismonth+"qq");
                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                int counternextbook=0;
                                                                                                                for (int p = 1; p < daysnextmonth + 1+counterholidaysnext; p++) {
                                                                                                                    if(p==monthLastDatenext +1){
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidaysnext !=null){
                                                                                                                        if(holidaysnext.contains(String.valueOf(p))) {
                                                                                                                            counterholidaysnext++;
                                                                                                                            System.out.println(counterholidaysnext+"rr");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb4 ss");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb4 ss");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    counternextbook++;
                                                                                                                }

                                                                                                                int daysnextnext=days-daysthismonth-counternextbook;
                                                                                                                System.out.println(daysnextnext);
                                                                                                                int counternextnextbook=0;
                                                                                                                for (int p = 1; p < daysnextnext + 1+counterholidaysnextnext; p++) {
                                                                                                                    if(p==monthLastDatenextnext +1){
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidaysnextnext!=null) {
                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                            counterholidaysnextnext++;
                                                                                                                            System.out.println(counterholidaysnext + "tt");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println( " fb5 uu");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println( " fb5 uu");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    counternextnextbook++;

                                                                                                                }

                                                                                                            }

                                                                                                            System.out.println("..bookmeal");
                                                                                                            alertDialogSuccessfulBooking();
                                                                                                            System.out.println("vv");
                                                                                                            System.out.println(counterthisholidays+"vva");
                                                                                                            System.out.println(i-counterthisholidays+"vvaa");

                                                                                                        }
                                                                                                        else if (booknext ==3)
                                                                                                        {
                                                                                                            {
                                                                                                                int counterholidaysnext=0;
                                                                                                                int counterholidaysthis = 0;
                                                                                                                int counterholidaysnextnext=0;

                                                                                                                for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                    if (l == monthLastDate + 1) {
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidays !=null){
                                                                                                                        if (holidays.contains(String.valueOf(l))) {
                                                                                                                            counterholidaysthis++;
                                                                                                                            System.out.println("wwa");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }
                                                                                                                    System.out.println((l+"ggg"));

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb6 ss");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb6 ss");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                }
                                                                                                                daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                System.out.println(daysthismonth+"hhh");
                                                                                                                daysnextmonth = days - daysthismonth;
                                                                                                                System.out.println(textMonthnext + " " + yn);
                                                                                                                int counternextbook=0;
                                                                                                                for (int p = 1; p < daysnextmonth + 1+counterholidaysnext; p++) {
                                                                                                                    if(p==monthLastDatenext +1){
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidaysnext !=null){
                                                                                                                        if(holidaysnext.contains(String.valueOf(p))) {
                                                                                                                            counterholidaysnext++;
                                                                                                                            System.out.println(counterholidaysnext+"iii");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb7 jjj");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb7 jjj");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    counternextbook++;
                                                                                                                }

                                                                                                                int daysnextnext=days-daysthismonth-counternextbook;
                                                                                                                System.out.println(daysnextnext+"kkk");
                                                                                                                int counternextnextbook=0;
                                                                                                                for (int p = 1; p < daysnextnext + 1+counterholidaysnextnext; p++) {
                                                                                                                    if(p==monthLastDatenextnext +1){
                                                                                                                        break;
                                                                                                                    }
                                                                                                                    if(holidaysnextnext!=null) {
                                                                                                                        if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                            counterholidaysnextnext++;
                                                                                                                            System.out.println(counterholidaysnext + "lll");
                                                                                                                            continue;
                                                                                                                        }
                                                                                                                    }

                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb8 mmm");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                            .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                            .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                @Override
                                                                                                                                public void onSuccess(Void aVoid) {
                                                                                                                                    System.out.println("fb8 mmm");
                                                                                                                                }
                                                                                                                            })
                                                                                                                            .addOnFailureListener(new OnFailureListener() {
                                                                                                                                @Override
                                                                                                                                public void onFailure(@NonNull Exception e) {
                                                                                                                                }
                                                                                                                            });
                                                                                                                    counternextnextbook++;

                                                                                                                }

                                                                                                            }

                                                                                                            System.out.println("..bookmealnext");
                                                                                                            alertDialogSuccessfulBooking();
                                                                                                            System.out.println(counternextholidays+"nnn");
                                                                                                            System.out.println("ooo");
                                                                                                            System.out.println(k - counternextholidays+"ppp");
                                                                                                        }

                                                                                                    }

                                                                                                }
                                                                                            });
                                                                                }

                                                                            }
                                                                        });

                                                            } else
                                                            {
                                                                AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                alert.setTitle(" Please update Profile with address");
                                                                alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                    @Override
                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                        if (document.exists()) {
                                                                            String phone= document.getString("phoneNo");
                                                                            //Toast.makeText(CustomCalendar.this, phone, Toast.LENGTH_SHORT).show();
                                                                            Intent intent=new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                            intent.putExtra("phone",phone);
                                                                            startActivity(intent);
                                                                            finish();
                                                                        }
//                                    Intent intent=new Intent(CustomCalendar.this, OtpUpdateProfile.class);
//                            startActivity(intent);
                                                                        //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                    }
                                                                }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                    @Override
                                                                    public void onClick(DialogInterface dialogInterface, int i) {
                                                                        Intent intent=new Intent(DatePicker1.this, MainActivity.class);
                                                                        startActivity(intent);
                                                                        finish();
                                                                    }
                                                                });
                                                                alert.show();

                                                            }
                                                        }
                                                    }

                                                }
                                            });



                                            //FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                            //DocumentReference docIdRef = firestore.collection("users").document(userID);


                                        }

                                    }
                                }
                            });
                        }

                    }

                },
                // on below line we are passing year,
                // month and day for selected date in our date picker.
                year, month, day);
        //Calendar calender = Calendar.getInstance();
//        long today = c1.getTimeInMillis();
//        final long oneDay = 24 * 60 * 60 * 1000L;
//
//        datePickerDialog.getDatePicker().setMinDate(today+oneDay);
//
//        datePickerDialog.getDatePicker().setMaxDate(today + 90 * oneDay);
        //Date nextMonth = new Date(today + 30 * oneDay);
        //Date previousDays = new Date(today - 1000);
        /*Calendar today = Calendar.getInstance();
        Calendar twoDaysAgo = (Calendar) today.clone();
        twoDaysAgo.add(Calendar.DATE, -2);
        Calendar twoDaysLater = (Calendar) today.clone();
        twoDaysLater.add(Calendar.DATE, 2);*/
        //datePickerDialog.getDatePicker().setMinDate(System.currentTimeMillis() - 1000);
        // at last we are calling show to
        // display our date picker dialog.
        //Toast.makeText(this, "show2", Toast.LENGTH_SHORT).show();
        //datePickerDialog.show();


    }
    public void addMealLunchDinnerCustomPlan(int days,String meal1,String meal2)
    {
        final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

        final Calendar c1 = Calendar.getInstance();

        // on below line we are getting
        // our day, month and year.
        int year = c1.get(Calendar.YEAR);
        int month = c1.get(Calendar.MONTH);
        int day = c1.get(Calendar.DAY_OF_MONTH);




        // on below line we are creating a variable for date picker dialog.
        DatePickerDialog datePickerDialog = new DatePickerDialog(
                // on below line we are passing context.
                DatePicker1.this,
                new DatePickerDialog.OnDateSetListener() {
                    @Override
                    public void onDateSet(DatePicker view, int year,
                                          int monthOfYear, int dayOfMonth){
                        {

                            if(monthOfYear<11){
                                monthOfYearNext=monthOfYear+1;
                                yearNext=year;
                            } else if (monthOfYear==11) {
                                monthOfYearNext=0;
                                yearNext=year+1;

                            }
                            if(monthOfYear<10){
                                monthOfYearNextnext=monthOfYear+2;
                                yearNextnext=year;
                            } else if (monthOfYear==10) {
                                monthOfYearNextnext=0;
                                yearNextnext=year+1;

                            }

                            textmonth=MONTHS[monthOfYear];
                            textMonthnext=MONTHS[monthOfYearNext];
                            textMonthnextnext=MONTHS[monthOfYearNextnext];
                            y=String.valueOf(year);
                            yn=String.valueOf(yearNext);
                            ynn=String.valueOf(yearNextnext);
                            tvinitialdate.setText("Initial Booking Date: "+dayOfMonth+"/"+(monthOfYear+1)+"/"+year);
                            t1 = c1.getTimeInMillis();
                            String y = String.valueOf(year);
                            Calendar c11=Calendar.getInstance();
                            Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                            int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                            Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                            int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                            Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                            int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                            System.out.println(monthLastDatenext);
                            FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                            DocumentReference docIdRef = firestore.collection("users").document(userID);
                            docIdRef.collection("events").document(meal2).get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                @Override
                                public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                    DocumentSnapshot documentSnapshot=task.getResult();
                                    if(documentSnapshot.exists()){
                                        ArrayList<String> bookeddaysthismonth1 = (ArrayList<String>) documentSnapshot.get(textmonth+" "+y);
                                        ArrayList<String> bookeddaysnextmonth1 = (ArrayList<String>) documentSnapshot.get(textMonthnext+" "+yn);
                                        ArrayList<String> bookeddaysnextnextmonth1 = (ArrayList<String>) documentSnapshot.get(textMonthnextnext+" "+ynn);
                                        {
                                            final String[] MONTHS = {"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"};

                                            final Calendar c1 = Calendar.getInstance();

                                            // on below line we are getting
                                            // our day, month and year.
                                            int year = c1.get(Calendar.YEAR);
                                            int month = c1.get(Calendar.MONTH);
                                            int day = c1.get(Calendar.DAY_OF_MONTH);




                                            // on below line we are creating a variable for date picker dialog.
                                            DatePickerDialog datePickerDialog = new DatePickerDialog(
                                                    // on below line we are passing context.
                                                    DatePicker1.this,
                                                    new DatePickerDialog.OnDateSetListener() {
                                                        @Override
                                                        public void onDateSet(DatePicker view, int year,
                                                                              int monthOfYear, int dayOfMonth){
                                                            {
                                                                DocumentReference documentReference=fstore.collection("users").document(userID).collection("events").document(meal1);
                                                                documentReference  .get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                    @Override
                                                                    public void onComplete(Task<DocumentSnapshot> task) {
                                                                        if(task.isSuccessful()){
                                                                            DocumentSnapshot documentSnapshot=task.getResult();
                                                                            if(documentSnapshot !=null){
                                                                                Map<String, Object> map=documentSnapshot.getData();
                                                                                fieldSizeDinner=map.size();
                                                                                System.out.println("....++"+fieldSizeDinner);
                                                                                DocumentReference documentReference1=fstore.collection("users").document(userID).collection("events").document(meal2);
                                                                                documentReference1  .get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                    @Override
                                                                                    public void onComplete(Task<DocumentSnapshot> task) {
                                                                                        if(task.isSuccessful()){
                                                                                            DocumentSnapshot documentSnapshot=task.getResult();
                                                                                            if(documentSnapshot !=null) {
                                                                                                Map<String, Object> map = documentSnapshot.getData();
                                                                                                fieldSizeLunch = map.size();
                                                                                                System.out.println("....++" + fieldSizeDinner);
                                                                                                System.out.println("sss.." + fieldSizeLunch + "ttt.." + fieldSizeDinner);
                                                                                                //System.out.println("value of a:"+a);
                                                                                                if (fieldSizeDinner < 2 && fieldSizeLunch < 2) {


                                                                                                    if (a < 7)
                                                                                                    {
                                                                                                        //Toast.makeText(CustomCalendar.this, "First time minimum 7 day booking allowed", Toast.LENGTH_SHORT).show();
                                                                                                        AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                        alert.setTitle(" First time Booking");
                                                                                                        alert.setMessage("First time booking, minimum 7 days required !!").setPositiveButton("ok", new DialogInterface.OnClickListener() {
                                                                                                            @Override
                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                cbcustom.setChecked(false);
                                                                                                                //Toast.makeText(CustomCalendar.this, "Thanks", Toast.LENGTH_SHORT).show();
                                                                                                            }
                                                                                                        }).setNegativeButton("cancel", new DialogInterface.OnClickListener() {
                                                                                                            @Override
                                                                                                            public void onClick(DialogInterface dialogInterface, int i) {

                                                                                                            }
                                                                                                        });
                                                                                                        alert.show();
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        System.out.println("ttta");

                                                                                                        if (monthOfYear < 11) {
                                                                                                            monthOfYearNext = monthOfYear + 1;
                                                                                                            yearNext = year;
                                                                                                        } else if (monthOfYear == 11) {
                                                                                                            monthOfYearNext = 0;
                                                                                                            yearNext = year + 1;

                                                                                                        }
                                                                                                        if (monthOfYear < 10) {
                                                                                                            monthOfYearNextnext = monthOfYear + 2;
                                                                                                            yearNextnext = year;
                                                                                                        } else if (monthOfYear == 10) {
                                                                                                            monthOfYearNextnext = 0;
                                                                                                            yearNextnext = year + 1;

                                                                                                        }

                                                                                                        textmonth = MONTHS[monthOfYear];
                                                                                                        textMonthnext = MONTHS[monthOfYearNext];
                                                                                                        textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                        //y = String.valueOf(year);
                                                                                                        yn = String.valueOf(yearNext);
                                                                                                        ynn = String.valueOf(yearNextnext);
                                                                                                        tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                        t1 = c1.getTimeInMillis();
                                                                                                        String y = String.valueOf(year);
                                                                                                        Calendar c11 = Calendar.getInstance();
                                                                                                        Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                        int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                        int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                        int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        System.out.println(monthLastDatenext);
                                                                                                        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                        DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                        docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                            @Override
                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                if (task.isSuccessful()) {
                                                                                                                    DocumentSnapshot document = task.getResult();
                                                                                                                    if (document.exists()) {
                                                                                                                        if (!document.get("name").equals("")) {
                                                                                                                            fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                    get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                        @Override
                                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                            if (task.isSuccessful()) {
                                                                                                                                                ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1).get()
                                                                                                                                                        .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                            @Override
                                                                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                                if (documentSnapshot.exists()) {
                                                                                                                                                                    ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                    ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                    ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                    System.out.println(textmonth + " " + y);
                                                                                                                                                                    //System.out.println("kll"+bookeddaysthismonth.get(0));
                                                                                                                                                                    int i = dayOfMonth;
                                                                                                                                                                    int counterthisholidays = 0;
                                                                                                                                                                    int counternextholidays = 0;
                                                                                                                                                                    int alreadybookednext = 0;
                                                                                                                                                                    int booknext = 0;
                                                                                                                                                                    int bookthis = 0;
                                                                                                                                                                    int alreadybooked = 0;
                                                                                                                                                                    int k = 1;
                                                                                                                                                                    int daysbookedthis;
                                                                                                                                                                    System.out.println(i + "uuu");
                                                                                                                                                                    while (i <= monthLastDate) {
                                                                                                                                                                        if (holidays != null) {
                                                                                                                                                                            if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println(i + "vvv");
                                                                                                                                                                                counterthisholidays++;
                                                                                                                                                                                System.out.println(counterthisholidays + "www");
                                                                                                                                                                            }
                                                                                                                                                                        }


                                                                                                                                                                        if (bookeddaysthismonth != null) {
                                                                                                                                                                            System.out.println("xxx");
                                                                                                                                                                            if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println("yyy");
                                                                                                                                                                                System.out.println(i);
                                                                                                                                                                                alreadybooked = 2;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                        if (bookeddaysthismonth1 != null) {
                                                                                                                                                                            System.out.println("xxx");
                                                                                                                                                                            if (bookeddaysthismonth1.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println("yyy");
                                                                                                                                                                                System.out.println(i);
                                                                                                                                                                                alreadybooked1 = 2;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                        if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                            bookthis = 1;
                                                                                                                                                                            System.out.println("aab");
                                                                                                                                                                            break;
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println("aac");

                                                                                                                                                                        i++;
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println(alreadybooked);
                                                                                                                                                                    System.out.println(bookthis);
                                                                                                                                                                    if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days)
                                                                                                                                                                    {

                                                                                                                                                                        daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;

                                                                                                                                                                        while (k <= monthLastDatenext) {
                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                System.out.println("aa");
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                    System.out.println("bb");
                                                                                                                                                                                    System.out.println(k + "c");
                                                                                                                                                                                    counternextholidays++;

                                                                                                                                                                                }
                                                                                                                                                                            }


                                                                                                                                                                            System.out.println(counternextholidays);

                                                                                                                                                                            if (bookeddaysnextmonth != null) {
                                                                                                                                                                                System.out.println("cc");
                                                                                                                                                                                if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                    alreadybookednext = 4;
                                                                                                                                                                                    System.out.println("dd");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            if (bookeddaysnextmonth1 != null) {
                                                                                                                                                                                System.out.println("cc");
                                                                                                                                                                                if (bookeddaysnextmonth1.contains(String.valueOf(k))) {
                                                                                                                                                                                    alreadybookednext = 4;
                                                                                                                                                                                    System.out.println("dd");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                                booknext = 3;
                                                                                                                                                                                System.out.println("ee");
                                                                                                                                                                                System.out.println(k);

                                                                                                                                                                                break;
                                                                                                                                                                            }

                                                                                                                                                                            k++;


                                                                                                                                                                        }


                                                                                                                                                                    }

                                                                                                                                                                    if (bookthis == 1)
                                                                                                                                                                    {
                                                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                                                        int counterholidaysnextnext = 0;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aacab"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println(("fb9 aacaba"));
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println(("fb9 aacaba"));
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb10 aaab");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb10 aaab");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb11 aaaba");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb11 aaaba");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        System.out.println("aaabba");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aaabbaa"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb12 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb12 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb13 aabbc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb13 aabbc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb14 aaabbb");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb14 aaabbb");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmeal");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println("f");
                                                                                                                                                                        System.out.println(counterthisholidays + "fa");
                                                                                                                                                                        System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                    }
                                                                                                                                                                    else if (booknext == 3)
                                                                                                                                                                    {
                                                                                                                                                                        {
                                                                                                                                                                            int counterholidaysnext = 0;
                                                                                                                                                                            int counterholidaysthis = 0;
                                                                                                                                                                            int counterholidaysnextnext = 0;

                                                                                                                                                                            System.out.println("not null not null");

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "abca"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb15 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb15 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb16 abcc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb16 abcc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb17 abcdaa");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb17 abcdaa");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmealnext");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println(counternextholidays);
                                                                                                                                                                        System.out.println("ffa");
                                                                                                                                                                        System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                    }

                                                                                                                                                                    if (alreadybooked == 2 ||alreadybooked1 == 2||alreadybookednext == 4 || alreadybookednext1 == 4)
                                                                                                                                                                    {
                                                                                                                                                                        System.out.println("already booked next..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ggaa");
                                                                                                                                                                    }

                                                                                                                                                                }

                                                                                                                                                            }
                                                                                                                                                        });
                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                    });

                                                                                                                        } else {
                                                                                                                            AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                            alert.setTitle(" Please update Profile with address");
                                                                                                                            alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    if (document.exists()) {
                                                                                                                                        String phone = document.getString("phoneNo");
                                                                                                                                        Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                        intent.putExtra("phone", phone);
                                                                                                                                        startActivity(intent);
                                                                                                                                        finish();
                                                                                                                                    }
//
                                                                                                                                }
                                                                                                                            }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                    startActivity(intent);
                                                                                                                                    finish();
                                                                                                                                }
                                                                                                                            });
                                                                                                                            alert.show();

                                                                                                                        }
                                                                                                                    }
                                                                                                                }

                                                                                                            }
                                                                                                        });

                                                                                                    }
                                                                                                }
                                                                                                else{
                                                                                                    {
                                                                                                        System.out.println("ttta");

                                                                                                        if (monthOfYear < 11) {
                                                                                                            monthOfYearNext = monthOfYear + 1;
                                                                                                            yearNext = year;
                                                                                                        } else if (monthOfYear == 11) {
                                                                                                            monthOfYearNext = 0;
                                                                                                            yearNext = year + 1;

                                                                                                        }
                                                                                                        if (monthOfYear < 10) {
                                                                                                            monthOfYearNextnext = monthOfYear + 2;
                                                                                                            yearNextnext = year;
                                                                                                        } else if (monthOfYear == 10) {
                                                                                                            monthOfYearNextnext = 0;
                                                                                                            yearNextnext = year + 1;

                                                                                                        }

                                                                                                        textmonth = MONTHS[monthOfYear];
                                                                                                        textMonthnext = MONTHS[monthOfYearNext];
                                                                                                        textMonthnextnext = MONTHS[monthOfYearNextnext];
                                                                                                        //y = String.valueOf(year);
                                                                                                        yn = String.valueOf(yearNext);
                                                                                                        ynn = String.valueOf(yearNextnext);
                                                                                                        tvinitialdate.setText("Initial Booking Date: " + dayOfMonth + "/" + (monthOfYear + 1) + "/" + year);
                                                                                                        t1 = c1.getTimeInMillis();
                                                                                                        String y = String.valueOf(year);
                                                                                                        Calendar c11 = Calendar.getInstance();
                                                                                                        Calendar mycal = new GregorianCalendar(year, monthOfYear, dayOfMonth);
                                                                                                        int monthLastDate = mycal.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnext = new GregorianCalendar(yearNext, monthOfYearNext, dayOfMonth);
                                                                                                        int monthLastDatenext = mycalnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        Calendar mycalnextnext = new GregorianCalendar(yearNextnext, monthOfYearNextnext, dayOfMonth);
                                                                                                        int monthLastDatenextnext = mycalnextnext.getActualMaximum(Calendar.DAY_OF_MONTH);
                                                                                                        System.out.println(monthLastDatenext);

                                                                                                        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
                                                                                                        DocumentReference docIdRef = firestore.collection("users").document(userID);
                                                                                                        docIdRef.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                            @Override
                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                if (task.isSuccessful()) {
                                                                                                                    DocumentSnapshot document = task.getResult();
                                                                                                                    if (document.exists()) {
                                                                                                                        if (!document.get("name").equals("")) {
                                                                                                                            fstore.collection("holidays").document("Ml4ziSIN1dW84IWC0YYD").
                                                                                                                                    get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                        @Override
                                                                                                                                        public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                            DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                            if (task.isSuccessful()) {
                                                                                                                                                ArrayList<String> holidays = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                ArrayList<String> holidaysnext = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                ArrayList<String> holidaysnextnext = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1).get()
                                                                                                                                                        .addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
                                                                                                                                                            @Override
                                                                                                                                                            public void onComplete(@androidx.annotation.NonNull Task<DocumentSnapshot> task) {
                                                                                                                                                                DocumentSnapshot documentSnapshot = task.getResult();
                                                                                                                                                                if (documentSnapshot.exists()) {
                                                                                                                                                                    ArrayList<String> bookeddaysthismonth = (ArrayList<String>) documentSnapshot.get(textmonth + " " + y);
                                                                                                                                                                    ArrayList<String> bookeddaysnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnext + " " + yn);
                                                                                                                                                                    ArrayList<String> bookeddaysnextnextmonth = (ArrayList<String>) documentSnapshot.get(textMonthnextnext + " " + ynn);
                                                                                                                                                                    System.out.println(textmonth + " " + y);
                                                                                                                                                                    int i = dayOfMonth;
                                                                                                                                                                    int counterthisholidays = 0;
                                                                                                                                                                    int counternextholidays = 0;
                                                                                                                                                                    int alreadybookednext = 0;
                                                                                                                                                                    int booknext = 0;
                                                                                                                                                                    int bookthis = 0;
                                                                                                                                                                    int alreadybooked = 0;
                                                                                                                                                                    int k = 1;
                                                                                                                                                                    int daysbookedthis;
                                                                                                                                                                    System.out.println(i + "uuu");
                                                                                                                                                                    while (i <= monthLastDate) {
                                                                                                                                                                        if (holidays != null) {
                                                                                                                                                                            if (holidays.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println(i + "vvv");
                                                                                                                                                                                counterthisholidays++;
                                                                                                                                                                                System.out.println(counterthisholidays + "www");
                                                                                                                                                                            }
                                                                                                                                                                        }



                                                                                                                                                                        if (bookeddaysthismonth != null) {
                                                                                                                                                                            System.out.println("xxx");
                                                                                                                                                                            if (bookeddaysthismonth.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println("yyy");
                                                                                                                                                                                System.out.println(i);
                                                                                                                                                                                alreadybooked = 2;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                        if (bookeddaysthismonth1 != null) {
                                                                                                                                                                            System.out.println("xxx");
                                                                                                                                                                            if (bookeddaysthismonth1.contains(String.valueOf(i))) {
                                                                                                                                                                                System.out.println("yyy");
                                                                                                                                                                                System.out.println(i);
                                                                                                                                                                                alreadybooked1 = 2;
                                                                                                                                                                                break;
                                                                                                                                                                            }
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println(counterthisholidays + "zzz");
                                                                                                                                                                        if (i - dayOfMonth - counterthisholidays == days - 1) {
                                                                                                                                                                            bookthis = 1;
                                                                                                                                                                            System.out.println("aab");
                                                                                                                                                                            break;
                                                                                                                                                                        }
                                                                                                                                                                        System.out.println("aac");

                                                                                                                                                                        i++;
                                                                                                                                                                    }
                                                                                                                                                                    System.out.println(alreadybooked);
                                                                                                                                                                    System.out.println(bookthis);
                                                                                                                                                                    if (bookthis == 1) {
                                                                                                                                                                        int counterholidaysnext = 0;
                                                                                                                                                                        int counterholidaysthis = 0;
                                                                                                                                                                        int counterholidaysnextnext = 0;
                                                                                                                                                                        System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(alreadybooked + "aaca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aacab"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println(("fb18 aacaba"));
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println(("fb18 aacaba"));
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb19 aaab");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb19 aaab");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaab");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb20 aaaba");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb20 aaaba");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }
                                                                                                                                                                        {

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        System.out.println("aaabba");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "aaabbaa"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb21 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb21 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaa");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb22 aabbc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb22 aabbc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "aaabbca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb23 aaabbb");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb23 aaabbb");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmeal");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println("f");
                                                                                                                                                                        System.out.println(counterthisholidays + "fa");
                                                                                                                                                                        System.out.println(i - counterthisholidays + "fb");

                                                                                                                                                                    }
                                                                                                                                                                    if (alreadybooked == 2||alreadybooked1 == 2) {
                                                                                                                                                                        System.out.println("already booked..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ga");

                                                                                                                                                                    }

                                                                                                                                                                    if (monthLastDate - dayOfMonth - counterthisholidays + 1 < days) {

                                                                                                                                                                        daysbookedthis = monthLastDate - dayOfMonth - counterthisholidays + 1;

                                                                                                                                                                        while (k <= monthLastDatenext) {

                                                                                                                                                                            if (holidaysnext != null) {
                                                                                                                                                                                System.out.println("aa");
                                                                                                                                                                                if (holidaysnext.contains(String.valueOf(k))) {
                                                                                                                                                                                    System.out.println("bb");
                                                                                                                                                                                    System.out.println(k + "c");
                                                                                                                                                                                    counternextholidays++;

                                                                                                                                                                                }
                                                                                                                                                                            }


                                                                                                                                                                            System.out.println(counternextholidays);

                                                                                                                                                                            if (bookeddaysnextmonth != null) {
                                                                                                                                                                                System.out.println("cc");
                                                                                                                                                                                if (bookeddaysnextmonth.contains(String.valueOf(k))) {
                                                                                                                                                                                    alreadybookednext = 4;
                                                                                                                                                                                    System.out.println("dd");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            if (bookeddaysnextmonth1 != null) {
                                                                                                                                                                                System.out.println("cc");
                                                                                                                                                                                if (bookeddaysnextmonth1.contains(String.valueOf(k))) {
                                                                                                                                                                                    alreadybookednext1 = 4;
                                                                                                                                                                                    System.out.println("dd");
                                                                                                                                                                                    System.out.println(k);

                                                                                                                                                                                    break;

                                                                                                                                                                                }

                                                                                                                                                                            }
                                                                                                                                                                            if (k - counternextholidays == days - daysbookedthis) {
                                                                                                                                                                                booknext = 3;
                                                                                                                                                                                System.out.println("ee");
                                                                                                                                                                                System.out.println(k);

                                                                                                                                                                                break;
                                                                                                                                                                            }

                                                                                                                                                                            k++;


                                                                                                                                                                        }


                                                                                                                                                                    }

                                                                                                                                                                    if (booknext == 3) {
                                                                                                                                                                        {
                                                                                                                                                                            int counterholidaysnext = 0;
                                                                                                                                                                            int counterholidaysthis = 0;
                                                                                                                                                                            int counterholidaysnextnext = 0;

                                                                                                                                                                            System.out.println("not null not null");

                                                                                                                                                                            for (int l = dayOfMonth; l < dayOfMonth + days + counterholidaysthis; l++) {
                                                                                                                                                                                if (l == monthLastDate + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidays != null) {
                                                                                                                                                                                    if (holidays.contains(String.valueOf(l))) {
                                                                                                                                                                                        counterholidaysthis++;
                                                                                                                                                                                        System.out.println(counterholidaysthis + "abca");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                System.out.println((l + "abca"));

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb24 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(MONTHS[monthOfYear] + " " + y, FieldValue.arrayUnion(String.valueOf(l)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb24 ss");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                            }
                                                                                                                                                                            daysthismonth = monthLastDate - dayOfMonth - counterholidaysthis + 1;
                                                                                                                                                                            System.out.println(daysthismonth);
                                                                                                                                                                            daysnextmonth = days - daysthismonth;
                                                                                                                                                                            System.out.println(textMonthnext + " " + yn);
                                                                                                                                                                            int counternextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextmonth + 1 + counterholidaysnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnext != null) {
                                                                                                                                                                                    if (holidaysnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcb");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb25 abcc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnext + " " + yn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb25 abcc");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextbook++;
                                                                                                                                                                            }

                                                                                                                                                                            int daysnextnext = days - daysthismonth - counternextbook;
                                                                                                                                                                            System.out.println(daysnextnext);
                                                                                                                                                                            int counternextnextbook = 0;
                                                                                                                                                                            for (int p = 1; p < daysnextnext + 1 + counterholidaysnextnext; p++) {
                                                                                                                                                                                if (p == monthLastDatenextnext + 1) {
                                                                                                                                                                                    break;
                                                                                                                                                                                }
                                                                                                                                                                                if (holidaysnextnext != null) {
                                                                                                                                                                                    if (holidaysnextnext.contains(String.valueOf(p))) {
                                                                                                                                                                                        counterholidaysnextnext++;
                                                                                                                                                                                        System.out.println(counterholidaysnext + "abcda");
                                                                                                                                                                                        continue;
                                                                                                                                                                                    }
                                                                                                                                                                                }

                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal1)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb26 abcdaa");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                fstore.collection("users").document(userID).collection("events").document(meal2)
                                                                                                                                                                                        .update(textMonthnextnext + " " + ynn, FieldValue.arrayUnion(String.valueOf(p)))
                                                                                                                                                                                        .addOnSuccessListener(new OnSuccessListener<Void>() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onSuccess(Void aVoid) {
                                                                                                                                                                                                System.out.println("fb26 abcdaa");
                                                                                                                                                                                            }
                                                                                                                                                                                        })
                                                                                                                                                                                        .addOnFailureListener(new OnFailureListener() {
                                                                                                                                                                                            @Override
                                                                                                                                                                                            public void onFailure(@NonNull Exception e) {
                                                                                                                                                                                            }
                                                                                                                                                                                        });
                                                                                                                                                                                counternextnextbook++;

                                                                                                                                                                            }

                                                                                                                                                                        }

                                                                                                                                                                        System.out.println("..bookmealnext");
                                                                                                                                                                        alertDialogSuccessfulBooking();
                                                                                                                                                                        System.out.println(counternextholidays);
                                                                                                                                                                        System.out.println("ffa");
                                                                                                                                                                        System.out.println(k - counternextholidays + "abcdaa");
                                                                                                                                                                    }
                                                                                                                                                                    if (alreadybookednext == 4||alreadybookednext1 == 4) {
                                                                                                                                                                        System.out.println("already booked next..");
                                                                                                                                                                        alertDialogAlreadyBooked();
                                                                                                                                                                        System.out.println("ggaa");
                                                                                                                                                                    }

                                                                                                                                                                }

                                                                                                                                                            }
                                                                                                                                                        });
                                                                                                                                            }

                                                                                                                                        }
                                                                                                                                    });

                                                                                                                        } else {
                                                                                                                            AlertDialog.Builder alert = new AlertDialog.Builder(DatePicker1.this);
                                                                                                                            alert.setTitle(" Please update Profile with address");
                                                                                                                            alert.setMessage("Profile update required before booking").setPositiveButton("Update profile now", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    if (document.exists()) {
                                                                                                                                        String phone = document.getString("phoneNo");
                                                                                                                                        //Toast.makeText(CustomCalendar.this, phone, Toast.LENGTH_SHORT).show();
                                                                                                                                        Intent intent = new Intent(DatePicker1.this, OtpUpdateProfile.class);
                                                                                                                                        intent.putExtra("phone", phone);
                                                                                                                                        startActivity(intent);
                                                                                                                                        finish();
                                                                                                                                    }
                                                                                                                                }
                                                                                                                            }).setNegativeButton("book later", new DialogInterface.OnClickListener() {
                                                                                                                                @Override
                                                                                                                                public void onClick(DialogInterface dialogInterface, int i) {
                                                                                                                                    Intent intent = new Intent(DatePicker1.this, MainActivity.class);
                                                                                                                                    startActivity(intent);
                                                                                                                                    finish();
                                                                                                                                }
                                                                                                                            });
                                                                                                                            alert.show();

                                                                                                                        }
                                                                                                                    }
                                                                                                                }

                                                                                                            }
                                                                                                        });

                                                                                                    }
                                                                                                }

                                                                                            }

                                                                                        }

                                                                                    }
                                                                                });

                                                                            }

                                                                        }

                                                                    }
                                                                });
                                                            }
                                                        }

                                                    },
                                                    // on below line we are passing year,
                                                    // month and day for selected date in our date picker.
                                                    year, month, day);



                                        }

                                    }
                                }
                            });
                        }

                    }

                },
                // on below line we are passing year,
                // month and day for selected date in our date picker.
                year, month, day);
        //Calendar calender = Calendar.getInstance();
//        long today = c1.getTimeInMillis();
//        final long oneDay = 24 * 60 * 60 * 1000L;
//
//        datePickerDialog.getDatePicker().setMinDate(today+oneDay);
//
//        datePickerDialog.getDatePicker().setMaxDate(today + 90 * oneDay);
        //Date nextMonth = new Date(today + 30 * oneDay);
        //Date previousDays = new Date(today - 1000);
        /*Calendar today = Calendar.getInstance();
        Calendar twoDaysAgo = (Calendar) today.clone();
        twoDaysAgo.add(Calendar.DATE, -2);
        Calendar twoDaysLater = (Calendar) today.clone();
        twoDaysLater.add(Calendar.DATE, 2);*/
        //datePickerDialog.getDatePicker().setMinDate(System.currentTimeMillis() - 1000);
        // at last we are calling show to
        // display our date picker dialog.
        //Toast.makeText(this, "show2", Toast.LENGTH_SHORT).show();
        //datePickerDialog.show();


    }
    public void sendNotificationtoAdmin()
    {
        DocumentReference documentReference1=fstore.collection("users")
                .document("3dccEvsBKKhN1i43DbsGIi0n4vy1");
        documentReference1.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
            @Override
            public void onComplete(Task<DocumentSnapshot> task) {
                if(task.isSuccessful()){
                    DocumentSnapshot documentSnapshot=task.getResult();
                    if(documentSnapshot!=null){
                        admin=(documentSnapshot.getBoolean("admin"));

                        if(admin.equals(true)){
                            token=(documentSnapshot.getString("token"));
                            FCMSend.pushNotification(DatePicker1.this,token,meal+" booked by ",name+", "+phone+" for "+dayb+" days");

                        }else
                        {

                        }

                    }
                }
            }
        });
        DocumentReference documentReference2=fstore.collection("users")
                .document("47w8q0KHu5SYNH9D2n1LgPDAs412");
        documentReference2.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
            @Override
            public void onComplete(Task<DocumentSnapshot> task) {
                if(task.isSuccessful()){
                    DocumentSnapshot documentSnapshot=task.getResult();
                    if(documentSnapshot!=null){
                        admin=(documentSnapshot.getBoolean("admin"));
                        assert admin != null;
                        if(admin.equals(true)){
                            token=(documentSnapshot.getString("token"));
                            FCMSend.pushNotification(DatePicker1.this,token,meal+" booked by ",name+", "+phone+" for "+dayb+" days");

                        }else
                        {

                        }

                    }
                }
            }
        });


        DocumentReference documentReference3=fstore.collection("users")
                .document("08cCG5LIEcYgvqKVXLOLN4DewZl2");
        documentReference3.get().addOnCompleteListener(new OnCompleteListener<DocumentSnapshot>() {
            @Override
            public void onComplete(Task<DocumentSnapshot> task) {
                if(task.isSuccessful()){
                    DocumentSnapshot documentSnapshot=task.getResult();
                    if(documentSnapshot!=null){
                        admin=(documentSnapshot.getBoolean("admin"));
                        if(admin.equals(true)){
                            token=(documentSnapshot.getString("token"));
                            FCMSend.pushNotification(DatePicker1.this,token,meal+" booked by ",name+", "+phone+" for "+dayb+" days");

                        }else
                        {

                        }

                    }
                }
            }
        });

    }

}


